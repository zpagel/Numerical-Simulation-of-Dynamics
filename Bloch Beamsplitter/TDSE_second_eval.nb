(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    109540,       2465]
NotebookOptionsPosition[    106376,       2419]
NotebookOutlinePosition[    106718,       2434]
CellTagsIndexPosition[    106675,       2431]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Solving the 1D time dependent Schrodinger equation", "Section",
 CellChangeTimes->{{3.7455036244554825`*^9, 
  3.7455036460380926`*^9}},ExpressionUUID->"66701289-77cc-4b93-9b7d-\
5f01bf8e8c07"],

Cell["\<\
First, let\[CloseCurlyQuote]s solve for Bragg diffraction. This will be the \
simplest to solve because it happens very fast. Therefore the position and \
time bounds on integration are small.\
\>", "Text",
 CellChangeTimes->{{3.745503657202985*^9, 3.7455036713391476`*^9}, {
   3.745503734974684*^9, 3.745503788407276*^9}, {3.7455038388834424`*^9, 
   3.7455039849603915`*^9}, {3.745504244434579*^9, 3.7455042827049394`*^9}, {
   3.745504344205162*^9, 3.745504355705547*^9}, {3.7455044164623833`*^9, 
   3.745504539075261*^9}, {3.74550459058949*^9, 3.745504629172309*^9}, {
   3.7455046610055056`*^9, 3.7455046683668833`*^9}, {3.7455047177777185`*^9, 
   3.7455047430578156`*^9}, {3.745504790704603*^9, 3.7455047920070705`*^9}, {
   3.745504828452306*^9, 3.745504964590331*^9}, {3.7455051217257767`*^9, 
   3.745505128436738*^9}, {3.7455053054532347`*^9, 3.7455054124494877`*^9}, {
   3.7455055320889964`*^9, 3.7455055826800394`*^9}, {3.745505631899927*^9, 
   3.7455057391730547`*^9}, {3.745505810459181*^9, 3.74550583481907*^9}, {
   3.745506018920811*^9, 3.745506075434641*^9}, {3.7455061418971725`*^9, 
   3.7455061640978055`*^9}, {3.7455064984325542`*^9, 3.745506526763862*^9}, {
   3.745506565215152*^9, 3.7455065724870095`*^9}, 3.745506612701668*^9, {
   3.7455067474760237`*^9, 3.745506749690864*^9}, {3.7455070547726946`*^9, 
   3.7455070586827154`*^9}, {3.7455076283145866`*^9, 3.745507644531578*^9}, {
   3.745507754361323*^9, 3.745507787300411*^9}, {3.7455078281812425`*^9, 
   3.7455078284091682`*^9}, {3.7455078790653877`*^9, 
   3.7455078900663424`*^9}, {3.74550792606151*^9, 3.745507960759823*^9}, {
   3.7455080458127675`*^9, 3.745508098033742*^9}, {3.745508162269261*^9, 
   3.7455081627112484`*^9}, {3.7455082363297544`*^9, 
   3.7455082418207054`*^9}, {3.7455083246789465`*^9, 3.745508360769211*^9}, {
   3.745508888269575*^9, 3.745509083224592*^9}, {3.7455091676128354`*^9, 
   3.745509262411154*^9}, {3.745509349885604*^9, 3.745509426822401*^9}, {
   3.745509523847493*^9, 3.745509864891259*^9}, {3.7455098997241135`*^9, 
   3.7455100374836164`*^9}, {3.7455100889297085`*^9, 3.745510130668782*^9}, {
   3.74551028182728*^9, 3.745510310582469*^9}, {3.745510392459525*^9, 
   3.7455104267394333`*^9}, {3.7455105054525127`*^9, 
   3.7455105883807974`*^9}, {3.7455107500110617`*^9, 
   3.7455107518089542`*^9}, {3.7455120219380655`*^9, 3.7455122200885*^9}, 
   3.745512250908598*^9, {3.7455123050188904`*^9, 3.7455124754330406`*^9}, {
   3.745512560708564*^9, 3.7455125795181575`*^9}, {3.7455127626251163`*^9, 
   3.7455127932937355`*^9}, {3.7455128282442274`*^9, 
   3.7455128631553698`*^9}, {3.7455128969067183`*^9, 
   3.7455129649100523`*^9}, {3.7455129977010813`*^9, 
   3.7455131545577087`*^9}, {3.7455131908214393`*^9, 
   3.7455131976298485`*^9}, {3.745513327814809*^9, 3.74551333027182*^9}, {
   3.7455135278634834`*^9, 3.745513537720195*^9}, {3.7455136819646664`*^9, 
   3.7455136824445333`*^9}, 3.745513714554242*^9, {3.745514486486293*^9, 
   3.745514509286493*^9}, {3.7455147421231995`*^9, 3.745514747282877*^9}, {
   3.7455147938140287`*^9, 3.745514794072771*^9}, {3.745515324921107*^9, 
   3.7455153261777496`*^9}, {3.745515391522193*^9, 3.745515392271165*^9}, {
   3.7455157249563246`*^9, 3.745515730556363*^9}, {3.745516065154415*^9, 
   3.745516066224554*^9}, {3.745517290901333*^9, 3.745517291805914*^9}, {
   3.745517346277382*^9, 3.745517357546276*^9}, {3.7455176396933584`*^9, 
   3.7455176432514057`*^9}, {3.7455186519769626`*^9, 
   3.7455186560560637`*^9}, {3.745519055635504*^9, 3.745519059400442*^9}, {
   3.7455208437511683`*^9, 3.745520887735656*^9}, 3.7455210161284733`*^9, {
   3.7455210782763443`*^9, 3.7455210792048655`*^9}, {3.7455218626013412`*^9, 
   3.745521875658185*^9}, {3.7455219461804867`*^9, 3.745521946335682*^9}, {
   3.745529704038851*^9, 3.7455297346720076`*^9}, {3.7455300515803146`*^9, 
   3.7455300636470737`*^9}, {3.7455301872298965`*^9, 3.745530197603182*^9}, {
   3.7455305193845186`*^9, 3.7455305256218553`*^9}, {3.7455306091855593`*^9, 
   3.7455306356837635`*^9}, {3.745530694837612*^9, 3.7455307024364944`*^9}, {
   3.7455355743183184`*^9, 
   3.745535628174429*^9}},ExpressionUUID->"28f44461-6f3c-4da7-8303-\
101559b45e7e"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"velocitySpread", " ", "=", " ", ".1"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Units", " ", "of", " ", 
      SubscriptBox["v", "r"]}], ",", " ", 
     RowBox[{
     "which", " ", "equals", " ", "one", " ", "in", " ", "these", " ", 
      "dimensionless", " ", 
      RowBox[{"units", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"positionSpread", " ", "=", " ", 
     FractionBox["1", 
      RowBox[{"2", " ", "velocitySpread"}]]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "assuming", " ", "minimum", " ", "uncertainty", " ", "wavepacket"}], " ", 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Psi]0", "[", "x", "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"Sqrt", "[", 
       FractionBox["Pi", "positionSpread"], "]"}], 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["x", "positionSpread"], ")"}], "2"]}], "]"}]}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "evaluate", " ", "solution", " ", "over", " ", "interval", " ", "x"}], 
     " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"lowPosBdry", "*", "positionSpread"}], ",", " ", 
       RowBox[{"highPosBdry", "*", "positionSpread"}]}], "}"}]}], "  ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lowPosBdry", " ", "=", " ", 
     RowBox[{"-", "10"}]}], ";"}], "  ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"highPosBdry", " ", "=", " ", "60"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lowTimeBdry", " ", "=", " ", 
     RowBox[{"-", "10"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"highTimeBdry", " ", "=", " ", 
     RowBox[{"-", "5"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tau", " ", "=", " ", ".2596"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"for", " ", "n"}], "=", "4"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n", " ", "=", " ", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"int", " ", "=", " ", "3.0871"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"for", " ", "n"}], "=", "5"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"5", "\[IndentingNewLine]", 
       RowBox[{"int", " ", "=", " ", "4.725368657396999"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"for", " ", "n"}], "=", "8"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{
       RowBox[{"8", "\[IndentingNewLine]", "int"}], " ", "=", " ", 
       "11.8533"}]}], ";"}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t1", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t2", " ", "=", " ", 
     RowBox[{"15", " ", "tau"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t3", " ", "=", " ", 
     RowBox[{"40", " ", "tau"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t4", " ", "=", " ", 
     RowBox[{"55", " ", "tau"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BraggPulse", "[", "t_", "]"}], " ", "=", "  ", 
     RowBox[{"2", " ", "Pi", " ", "int", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{
          FractionBox[
           RowBox[{"-", "1"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox[
             RowBox[{"t", "-", "t1"}], "tau"], ")"}], "2"]}], "]"}], "  ", 
        "+", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{
          FractionBox[
           RowBox[{"-", "1"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox[
             RowBox[{"t", "-", "t2"}], "tau"], ")"}], "2"]}], "]"}], " ", "+",
         " ", 
        RowBox[{"Exp", "[", 
         RowBox[{
          FractionBox[
           RowBox[{"-", "1"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox[
             RowBox[{"t", "-", "t3"}], "tau"], ")"}], "2"]}], "]"}]}], " ", 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fBragg", " ", "=", " ", 
     RowBox[{"4", " ", "n"}]}], ";"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"in", " ", "terms", " ", "of", " ", "velocity"}], ",", " ", 
     RowBox[{
     "this", " ", "value", " ", "make", " ", "a", " ", "lattice", " ", 
      "moving", " ", "halfway", " ", "between", " ", "the", " ", "0", " ", 
      "and", " ", "n", " ", "momentum", " ", "states"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"wm", " ", "=", " ", 
     RowBox[{"8", " ", "n"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Ham", "[", 
      RowBox[{"x", ",", "t"}], "]"}], " ", "=", " ", 
     RowBox[{"2", " ", "Pi", " ", "int", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           FractionBox[
            RowBox[{"-", "1"}], "2"], 
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox[
              RowBox[{"t", "-", "t1"}], "tau"], ")"}], "2"]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", " ", "+", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"fBragg", " ", "t"}], " ", "-", " ", 
              RowBox[{"2", " ", "x"}]}], ")"}], "]"}]}], ")"}]}], "  ", "+", 
        " ", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           FractionBox[
            RowBox[{"-", "1"}], "2"], 
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox[
              RowBox[{"t", "-", "t2"}], "tau"], ")"}], "2"]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", " ", "+", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"fBragg", " ", "t"}], " ", "-", " ", 
              RowBox[{"2", " ", "x"}]}], ")"}], "]"}]}], ")"}]}], " ", "+", 
        " ", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           FractionBox[
            RowBox[{"-", "1"}], "2"], 
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox[
              RowBox[{"t", "-", "t3"}], "tau"], ")"}], "2"]}], "]"}], 
         RowBox[{"(", " ", 
          RowBox[{"2", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"fBragg", " ", "t"}], " ", "-", " ", 
              RowBox[{"2", " ", "x"}]}], ")"}], "]"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"wm", " ", "t"}], "]"}]}], ")"}]}], "+", " ", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           FractionBox[
            RowBox[{"-", "1"}], "2"], 
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox[
              RowBox[{"t", "-", "t4"}], "tau"], ")"}], "2"]}], "]"}], 
         RowBox[{"(", " ", 
          RowBox[{"2", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"fBragg", " ", "t"}], " ", "-", " ", 
              RowBox[{"2", " ", "x"}]}], ")"}], "]"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"wm", " ", "t"}], "]"}]}], ")"}]}]}], " ", ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Psi]", "=", 
     RowBox[{"u", "/.", 
      RowBox[{"First", "@", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"I", " ", 
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"u", "[", 
                RowBox[{"t", ",", "x"}], "]"}], ",", "t"}], "]"}]}], 
            "\[Equal]", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"u", "[", 
                 RowBox[{"t", ",", "x"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "2"}], "}"}]}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"Ham", "[", 
               RowBox[{"x", ",", "t"}], "]"}], " ", 
              RowBox[{"u", "[", 
               RowBox[{"t", ",", "x"}], "]"}]}]}]}], ",", 
           RowBox[{
            RowBox[{"u", "[", 
             RowBox[{
              RowBox[{"lowTimeBdry", " ", "tau"}], ",", "x"}], "]"}], 
            "\[Equal]", 
            RowBox[{"\[Psi]0", "[", "x", "]"}]}], ",", 
           RowBox[{
            RowBox[{"u", "[", 
             RowBox[{"t", ",", 
              RowBox[{"lowPosBdry", " ", "positionSpread"}]}], "]"}], 
            "\[Equal]", 
            RowBox[{"u", "[", 
             RowBox[{"t", ",", 
              RowBox[{"highPosBdry", " ", "positionSpread"}]}], "]"}]}]}], 
          "}"}], ",", "u", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{"lowTimeBdry", " ", "tau"}], ",", " ", 
           RowBox[{"highTimeBdry", " ", "tau"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{"lowPosBdry", " ", "positionSpread"}], ",", 
           RowBox[{"highPosBdry", " ", "positionSpread"}]}], "}"}], ",", 
         RowBox[{"Method", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<MethodOfLines\>\"", ",", 
            RowBox[{"\"\<SpatialDiscretization\>\"", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\"\<TensorProductGrid\>\"", ",", 
               RowBox[{
               "\"\<DifferenceOrder\>\"", "\[Rule]", 
                "\"\<Pseudospectral\>\""}]}], "}"}]}]}], "}"}]}], ",", " ", 
         RowBox[{"MaxStepFraction", "\[Rule]", 
          FractionBox["1", "100"]}]}], " ", "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.745503657202985*^9, 3.7455036713391476`*^9}, {
   3.745503734974684*^9, 3.745503788407276*^9}, {3.7455038388834424`*^9, 
   3.7455039849603915`*^9}, {3.745504244434579*^9, 3.7455042827049394`*^9}, {
   3.745504344205162*^9, 3.745504355705547*^9}, {3.7455044164623833`*^9, 
   3.745504539075261*^9}, {3.74550459058949*^9, 3.745504629172309*^9}, {
   3.7455046610055056`*^9, 3.7455046683668833`*^9}, {3.7455047177777185`*^9, 
   3.7455047430578156`*^9}, {3.745504790704603*^9, 3.7455047920070705`*^9}, {
   3.745504828452306*^9, 3.745504964590331*^9}, {3.7455051217257767`*^9, 
   3.745505128436738*^9}, {3.7455053054532347`*^9, 3.7455054124494877`*^9}, {
   3.7455055320889964`*^9, 3.7455055826800394`*^9}, {3.745505631899927*^9, 
   3.7455057391730547`*^9}, {3.745505810459181*^9, 3.74550583481907*^9}, {
   3.745506018920811*^9, 3.745506075434641*^9}, {3.7455061418971725`*^9, 
   3.7455061640978055`*^9}, {3.7455064984325542`*^9, 3.745506526763862*^9}, {
   3.745506565215152*^9, 3.7455065724870095`*^9}, 3.745506612701668*^9, {
   3.7455067474760237`*^9, 3.745506749690864*^9}, {3.7455070547726946`*^9, 
   3.7455070586827154`*^9}, {3.7455076283145866`*^9, 3.745507644531578*^9}, {
   3.745507754361323*^9, 3.745507787300411*^9}, {3.7455078281812425`*^9, 
   3.7455078284091682`*^9}, {3.7455078790653877`*^9, 
   3.7455078900663424`*^9}, {3.74550792606151*^9, 3.745507960759823*^9}, {
   3.7455080458127675`*^9, 3.745508098033742*^9}, {3.745508162269261*^9, 
   3.7455081627112484`*^9}, {3.7455082363297544`*^9, 
   3.7455082418207054`*^9}, {3.7455083246789465`*^9, 3.745508360769211*^9}, {
   3.745508888269575*^9, 3.745509083224592*^9}, {3.7455091676128354`*^9, 
   3.745509262411154*^9}, {3.745509349885604*^9, 3.745509426822401*^9}, {
   3.745509523847493*^9, 3.745509864891259*^9}, {3.7455098997241135`*^9, 
   3.7455100374836164`*^9}, {3.7455100889297085`*^9, 3.745510130668782*^9}, {
   3.74551028182728*^9, 3.745510310582469*^9}, {3.745510392459525*^9, 
   3.7455104267394333`*^9}, {3.7455105054525127`*^9, 
   3.7455105883807974`*^9}, {3.7455107500110617`*^9, 
   3.7455107518089542`*^9}, {3.7455120219380655`*^9, 3.7455122200885*^9}, 
   3.745512250908598*^9, {3.7455123050188904`*^9, 3.7455124754330406`*^9}, {
   3.745512560708564*^9, 3.7455125795181575`*^9}, {3.7455127626251163`*^9, 
   3.7455127932937355`*^9}, {3.7455128282442274`*^9, 
   3.7455128631553698`*^9}, {3.7455128969067183`*^9, 
   3.7455129649100523`*^9}, {3.7455129977010813`*^9, 
   3.7455131545577087`*^9}, {3.7455131908214393`*^9, 
   3.7455131976298485`*^9}, {3.745513327814809*^9, 3.74551333027182*^9}, {
   3.7455135278634834`*^9, 3.745513537720195*^9}, {3.7455136819646664`*^9, 
   3.7455136824445333`*^9}, 3.745513714554242*^9, {3.745514486486293*^9, 
   3.745514509286493*^9}, {3.7455147421231995`*^9, 3.745514747282877*^9}, {
   3.7455147938140287`*^9, 3.745514794072771*^9}, {3.745515324921107*^9, 
   3.7455153261777496`*^9}, {3.745515391522193*^9, 3.745515392271165*^9}, {
   3.7455157249563246`*^9, 3.745515730556363*^9}, {3.745516065154415*^9, 
   3.745516066224554*^9}, {3.745517290901333*^9, 3.745517291805914*^9}, {
   3.745517346277382*^9, 3.745517357546276*^9}, {3.7455176396933584`*^9, 
   3.7455176432514057`*^9}, {3.7455186519769626`*^9, 
   3.7455186560560637`*^9}, {3.745519055635504*^9, 3.745519059400442*^9}, {
   3.7455208437511683`*^9, 3.745520887735656*^9}, 3.7455210161284733`*^9, {
   3.7455210782763443`*^9, 3.7455210792048655`*^9}, {3.7455218626013412`*^9, 
   3.745521875658185*^9}, {3.7455219461804867`*^9, 3.745521946335682*^9}, {
   3.745529704038851*^9, 3.7455297346720076`*^9}, {3.7455300515803146`*^9, 
   3.7455300636470737`*^9}, {3.7455301872298965`*^9, 3.745530197603182*^9}, {
   3.7455305193845186`*^9, 3.7455305256218553`*^9}, {3.7455306091855593`*^9, 
   3.7455306356837635`*^9}, {3.745530694837612*^9, 3.7455307024364944`*^9}, {
   3.7455355743183184`*^9, 3.7455355762960367`*^9}, {3.7457094258357544`*^9, 
   3.7457095489199867`*^9}, {3.745710272277596*^9, 3.7457102998436413`*^9}, {
   3.7457105578925323`*^9, 3.745710558080018*^9}, {3.7457106693116417`*^9, 
   3.7457106950466537`*^9}, {3.7457107365568027`*^9, 3.745710778976832*^9}, 
   3.7457108156590743`*^9, {3.745710848489064*^9, 3.7457108818675833`*^9}, {
   3.7457109276742764`*^9, 3.745710951308652*^9}, {3.7457109958293085`*^9, 
   3.7457110401919866`*^9}, {3.7457111012082815`*^9, 
   3.7457111401933107`*^9}, {3.7457111855351505`*^9, 
   3.7457112107852736`*^9}, {3.7457113334901524`*^9, 
   3.7457113354115763`*^9}, {3.745711530195545*^9, 3.7457115387185526`*^9}, {
   3.745712548044448*^9, 3.7457125594395103`*^9}, {3.745722009333226*^9, 
   3.745722035202283*^9}, {3.7457220680065513`*^9, 3.745722068022171*^9}, {
   3.7457226369014654`*^9, 3.7457226382937126`*^9}, {3.745759252152095*^9, 
   3.745759267934123*^9}, {3.7457592999749947`*^9, 3.7457593200972557`*^9}, {
   3.74575953593401*^9, 3.7457595529109383`*^9}, {3.745759660956499*^9, 
   3.745759685048517*^9}, {3.7457597480002313`*^9, 3.745759754013152*^9}, {
   3.7457597864893694`*^9, 3.7457598413214774`*^9}, {3.7457604149223766`*^9, 
   3.7457604365335817`*^9}, {3.7457604881674595`*^9, 
   3.7457605069941096`*^9}, {3.7457606608864584`*^9, 3.745760707248478*^9}, {
   3.7457607679294395`*^9, 3.7457607693596153`*^9}, {3.7457610031144695`*^9, 
   3.7457610032122073`*^9}, {3.745808393704357*^9, 3.7458083940094957`*^9}, {
   3.7458087547110853`*^9, 3.7458087643358154`*^9}, {3.745808909638133*^9, 
   3.7458089102373495`*^9}, {3.7460241945996933`*^9, 
   3.7460242330315027`*^9}, {3.746024338201812*^9, 3.746024374617813*^9}, {
   3.7460244495849113`*^9, 3.7460244624951153`*^9}, {3.746024617179098*^9, 
   3.7460246417365675`*^9}},ExpressionUUID->"2cb89133-37e0-4820-bfaa-\
bb83990bee4b"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Plot", " ", "Bragg", " ", "results", " ", "and", " ", "export", " ", 
    "gif"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Plot3D", "[", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Abs", "[", 
        RowBox[{"\[Psi]", "[", 
         RowBox[{"t", ",", "x"}], "]"}], "]"}], "2"], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", 
        RowBox[{"lowTimeBdry", " ", "tau"}], ",", 
        RowBox[{"highTimeBdry", " ", "tau"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"lowPosBdry", " ", "positionSpread"}], ",", 
        RowBox[{"highPosBdry", " ", "positionSpread"}]}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
      RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}], ",", " ", 
      RowBox[{"PlotPoints", "\[Rule]", "100"}]}], "]"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Plot3D", "[", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"Ham", "[", 
        RowBox[{"x", ",", "t"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", 
        RowBox[{"lowTimeBdry", " ", "tau"}], ",", 
        RowBox[{"highTimeBdry", " ", "tau"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"lowPosBdry", " ", "positionSpread"}], ",", 
        RowBox[{"highPosBdry", " ", "positionSpread"}]}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
      RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}], ",", " ", 
      RowBox[{"PlotPoints", "\[Rule]", "50"}]}], "]"}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"atomDensity", " ", "=", " ", 
    RowBox[{"DensityPlot", "[", 
     RowBox[{
      RowBox[{"Log", "[", 
       RowBox[{"Abs", "[", 
        RowBox[{"\[Psi]", "[", 
         RowBox[{"t", ",", "x"}], "]"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{
         RowBox[{"-", "3"}], "positionSpread"}], ",", " ", 
        RowBox[{"6", "positionSpread"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", 
        RowBox[{
         RowBox[{"-", "3"}], " ", "tau"}], ",", 
        RowBox[{"7", " ", "tau"}]}], "}"}], ",", 
      RowBox[{"ColorFunction", "\[Rule]", "\"\<CMYKColors\>\""}], ",", 
      RowBox[{"PlotPoints", "\[Rule]", "1000"}], ",", " ", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
      RowBox[{"FrameLabel", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Time\>\"", ",", " ", "Large"}], "]"}], ",", " ", 
           "\"\<\>\""}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Position\>\"", ",", " ", "Large"}], "]"}], ",", " ", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<Wavefunction Amplitude\>\"", ",", " ", "Large"}], 
              "]"}], ",", " ", "Large"}], "]"}]}], "}"}]}], "}"}]}], ",", " ", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{"\"\<braggLogDiffractionDensity.png\>\"", ",", "atomDensity"}], 
    "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"atomDensity", " ", "=", " ", 
    RowBox[{"DensityPlot", "[", 
     RowBox[{
      RowBox[{"Sqrt", "[", 
       RowBox[{"Abs", "[", 
        RowBox[{"\[Psi]", "[", 
         RowBox[{"t", ",", "x"}], "]"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{
         RowBox[{"-", "3"}], "positionSpread"}], ",", " ", 
        RowBox[{"6", "positionSpread"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", 
        RowBox[{
         RowBox[{"-", "3"}], " ", "tau"}], ",", 
        RowBox[{"7", " ", "tau"}]}], "}"}], ",", 
      RowBox[{"ColorFunction", "\[Rule]", "\"\<CMYKColors\>\""}], ",", 
      RowBox[{"PlotPoints", "\[Rule]", "1000"}], ",", " ", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
      RowBox[{"FrameLabel", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Time\>\"", ",", " ", "Large"}], "]"}], ",", " ", 
           "\"\<\>\""}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Position\>\"", ",", " ", "Large"}], "]"}], ",", " ", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<Wavefunction Amplitude\>\"", ",", " ", "Large"}], 
              "]"}], ",", " ", "Large"}], "]"}]}], "}"}]}], "}"}]}], ",", " ", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{"\"\<braggSqrtDiffractionDensity.png\>\"", ",", "atomDensity"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7455132138995647`*^9, 3.7455132878088636`*^9}, {
   3.745513722340562*^9, 3.7455137259924407`*^9}, {3.745513815156917*^9, 
   3.7455138210758305`*^9}, {3.745514316228894*^9, 3.745514333329686*^9}, 
   3.7455143876925087`*^9, {3.7455144228242054`*^9, 3.7455144308326893`*^9}, {
   3.7455145298052635`*^9, 3.7455145331152115`*^9}, {3.7455146867817974`*^9, 
   3.7455146907515917`*^9}, {3.7455162365750246`*^9, 
   3.7455162373209186`*^9}, {3.7455174233833756`*^9, 
   3.7455174358191547`*^9}, {3.7455181377987003`*^9, 3.74551814243631*^9}, {
   3.7455182126078367`*^9, 3.7455182128461976`*^9}, {3.7455183250364895`*^9, 
   3.745518328221943*^9}, {3.74551843485306*^9, 3.745518447769547*^9}, {
   3.745520050412741*^9, 3.745520055448289*^9}, {3.7455200891532373`*^9, 
   3.7455201009098277`*^9}, {3.7455204788999476`*^9, 
   3.7455204962575703`*^9}, {3.745520899687722*^9, 3.7455209183867607`*^9}, {
   3.7455211604099064`*^9, 3.745521178777833*^9}, {3.745522203208664*^9, 
   3.7455222087865486`*^9}, {3.745522495593748*^9, 3.745522523138627*^9}, {
   3.745522706156953*^9, 3.7455227096945896`*^9}, {3.745530723369568*^9, 
   3.7455307541194124`*^9}, {3.745548123045167*^9, 3.7455481245566993`*^9}, {
   3.745548319822291*^9, 3.7455483357395306`*^9}, {3.7455483714256535`*^9, 
   3.745548380480036*^9}, {3.7456017528248262`*^9, 3.745601757162262*^9}, {
   3.7456019880083046`*^9, 3.7456020164592705`*^9}, {3.7456020721305118`*^9, 
   3.745602073848898*^9}, {3.745710578733965*^9, 3.745710624264513*^9}, {
   3.745710736588043*^9, 3.7457107513415613`*^9}, {3.745710786324831*^9, 
   3.7457108088445024`*^9}, {3.745711261577861*^9, 3.7457112728186617`*^9}, {
   3.7457126017748194`*^9, 3.7457126123817534`*^9}, {3.7457130271157265`*^9, 
   3.7457130359261723`*^9}, {3.7457143621333537`*^9, 
   3.7457144019066067`*^9}, {3.7457145879183316`*^9, 
   3.7457146002084885`*^9}, {3.745716917141678*^9, 3.7457169615272255`*^9}, {
   3.745716992703456*^9, 3.7457170224251256`*^9}, {3.7457170832239356`*^9, 
   3.7457170980912075`*^9}, {3.7457171497817717`*^9, 
   3.7457171508259816`*^9}, {3.7457174902110586`*^9, 3.7457175344251785`*^9}, 
   3.745718012986154*^9, {3.7457180806037197`*^9, 3.7457180807443137`*^9}, {
   3.7457230648363104`*^9, 3.7457230671864915`*^9}, {3.7457232111243286`*^9, 
   3.745723215371827*^9}, {3.745723518035054*^9, 3.7457235295383263`*^9}, {
   3.745723669993801*^9, 3.7457236703059654`*^9}, {3.7457241465632877`*^9, 
   3.7457241693633566`*^9}, {3.745725071669984*^9, 3.745725098150217*^9}, {
   3.7457252907395287`*^9, 
   3.7457253023714433`*^9}},ExpressionUUID->"1ba31ce5-6638-4346-9a68-\
6e10f336784e"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"pl", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Re", "[", 
            RowBox[{"\[Psi]", "[", 
             RowBox[{"t", ",", "x"}], "]"}], "]"}], ",", " ", 
           RowBox[{"Im", "[", 
            RowBox[{"\[Psi]", "[", 
             RowBox[{"t", ",", "x"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{"lowPosBdry", " ", "positionSpread"}], ",", 
           RowBox[{"highPosBdry", " ", "positionSpread"}]}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", " ", "1"}], "}"}]}], ",", " ", 
         RowBox[{"Ticks", "\[Rule]", " ", "None"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{"lowTimeBdry", " ", "tau"}], ",", 
         RowBox[{"highTimeBdry", " ", "tau"}], ",", ".025"}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{"\"\<braggMZInterferometerWF.gif\>\"", ",", "pl", ",", 
     RowBox[{"AnimationRepetitions", "\[Rule]", "Infinity"}], ",", 
     RowBox[{"\"\<DisplayDurations\>\"", "\[Rule]", ".05"}]}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pl", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Plot", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Abs", "[", 
           RowBox[{"\[Psi]", "[", 
            RowBox[{"t", ",", "x"}], "]"}], "]"}], "2"], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{"lowPosBdry", " ", "positionSpread"}], ",", 
           RowBox[{"highPosBdry", " ", "positionSpread"}]}], "}"}], ",", 
         RowBox[{"Ticks", "\[Rule]", "None"}], ",", " ", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "1"}], "}"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{"lowTimeBdry", " ", "tau"}], ",", 
         RowBox[{"highTimeBdry", " ", "tau"}], ",", ".025"}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{"\"\<braggMZInterferometerAmp.gif\>\"", ",", "pl", ",", 
     RowBox[{"AnimationRepetitions", "\[Rule]", "Infinity"}], ",", 
     RowBox[{"\"\<DisplayDurations\>\"", "\[Rule]", ".05"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pl", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"Ham", "[", 
          RowBox[{"x", ",", "t"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{"lowPosBdry", " ", "positionSpread"}], ",", 
           RowBox[{"highPosBdry", " ", "positionSpread"}]}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", 
            FractionBox["1.05", 
             RowBox[{"4", " ", "Pi", " ", "int"}]]}], "}"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{"lowTimeBdry", " ", "tau"}], ",", 
         RowBox[{"highTimeBdry", " ", "tau"}], ",", ".025"}], "}"}], ",", " ", 
       RowBox[{"Ticks", "\[Rule]", " ", "None"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{"\"\<braggIntHam.gif\>\"", ",", "pl", ",", 
     RowBox[{"AnimationRepetitions", "\[Rule]", "Infinity"}], ",", 
     RowBox[{"\"\<DisplayDurations\>\"", "\[Rule]", ".05"}]}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7455132138995647`*^9, 3.7455132878088636`*^9}, {
   3.745513722340562*^9, 3.7455137259924407`*^9}, {3.745513815156917*^9, 
   3.7455138210758305`*^9}, {3.745514316228894*^9, 3.745514333329686*^9}, 
   3.7455143876925087`*^9, {3.7455144228242054`*^9, 3.7455144308326893`*^9}, {
   3.7455145298052635`*^9, 3.7455145331152115`*^9}, {3.7455146867817974`*^9, 
   3.7455146907515917`*^9}, {3.7455162365750246`*^9, 
   3.7455162373209186`*^9}, {3.7455174233833756`*^9, 
   3.7455174358191547`*^9}, {3.7455181377987003`*^9, 3.74551814243631*^9}, {
   3.7455182126078367`*^9, 3.7455182128461976`*^9}, {3.7455183250364895`*^9, 
   3.745518328221943*^9}, {3.74551843485306*^9, 3.745518447769547*^9}, {
   3.745520050412741*^9, 3.745520055448289*^9}, {3.7455200891532373`*^9, 
   3.7455201009098277`*^9}, {3.7455204788999476`*^9, 
   3.7455204962575703`*^9}, {3.745520899687722*^9, 3.7455209183867607`*^9}, {
   3.7455211604099064`*^9, 3.745521178777833*^9}, {3.745522203208664*^9, 
   3.7455222087865486`*^9}, {3.745522495593748*^9, 3.745522523138627*^9}, {
   3.745522706156953*^9, 3.7455227096945896`*^9}, {3.745530723369568*^9, 
   3.7455307541194124`*^9}, {3.745548123045167*^9, 3.7455481245566993`*^9}, {
   3.745548319822291*^9, 3.7455483357395306`*^9}, {3.7455483714256535`*^9, 
   3.745548380480036*^9}, {3.7456017528248262`*^9, 3.745601757162262*^9}, {
   3.7456019880083046`*^9, 3.7456020164592705`*^9}, {3.7456020721305118`*^9, 
   3.745602073848898*^9}, {3.745710578733965*^9, 3.745710624264513*^9}, {
   3.745710736588043*^9, 3.7457107513415613`*^9}, {3.745710786324831*^9, 
   3.7457108088445024`*^9}, {3.745711261577861*^9, 3.7457112728186617`*^9}, {
   3.7457126017748194`*^9, 3.7457126123817534`*^9}, {3.7457130271157265`*^9, 
   3.7457130359261723`*^9}, {3.7457143621333537`*^9, 
   3.7457144019066067`*^9}, {3.7457145879183316`*^9, 
   3.7457146002084885`*^9}, {3.745716917141678*^9, 3.7457169615272255`*^9}, {
   3.745716992703456*^9, 3.7457170224251256`*^9}, {3.7457170832239356`*^9, 
   3.7457170980912075`*^9}, {3.7457171497817717`*^9, 
   3.7457171508259816`*^9}, {3.7457174902110586`*^9, 3.7457175344251785`*^9}, 
   3.745718012986154*^9, {3.7457180806037197`*^9, 3.7457180807443137`*^9}, {
   3.7457230648363104`*^9, 
   3.7457230671864915`*^9}},ExpressionUUID->"c4b57cfe-78de-4cfa-9af6-\
f88ea5bf4f3e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pl", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"Ham", "[", 
        RowBox[{"x", ",", "t"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"lowPosBdry", " ", "positionSpread"}], ",", 
         RowBox[{"highPosBdry", " ", "positionSpread"}]}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", 
          FractionBox["1", 
           RowBox[{"4", " ", "Pi", " ", "int"}]]}], "}"}]}], ",", " ", 
       RowBox[{"Ticks", " ", "\[Rule]", " ", "None"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", 
       RowBox[{"lowTimeBdry", " ", "tau"}], ",", 
       RowBox[{"highTimeBdry", " ", "tau"}], ",", ".025"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<braggIntHam.gif\>\"", ",", "pl", ",", 
    RowBox[{"AnimationRepetitions", "\[Rule]", "Infinity"}], ",", 
    RowBox[{"\"\<DisplayDurations\>\"", "\[Rule]", ".05"}]}], "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7455132138995647`*^9, 3.7455132878088636`*^9}, {
   3.745513722340562*^9, 3.7455137259924407`*^9}, {3.745513815156917*^9, 
   3.7455138210758305`*^9}, {3.745514316228894*^9, 3.745514333329686*^9}, 
   3.7455143876925087`*^9, {3.7455144228242054`*^9, 3.7455144308326893`*^9}, {
   3.7455145298052635`*^9, 3.7455145331152115`*^9}, {3.7455146867817974`*^9, 
   3.7455146907515917`*^9}, {3.7455162365750246`*^9, 
   3.7455162373209186`*^9}, {3.7455174233833756`*^9, 
   3.7455174358191547`*^9}, {3.7455181377987003`*^9, 3.74551814243631*^9}, {
   3.7455182126078367`*^9, 3.7455182128461976`*^9}, {3.7455183250364895`*^9, 
   3.745518328221943*^9}, {3.74551843485306*^9, 3.745518447769547*^9}, {
   3.745520050412741*^9, 3.745520055448289*^9}, {3.7455200891532373`*^9, 
   3.7455201009098277`*^9}, {3.7455204788999476`*^9, 
   3.7455204962575703`*^9}, {3.745520899687722*^9, 3.7455209183867607`*^9}, {
   3.7455211604099064`*^9, 3.745521178777833*^9}, {3.745522203208664*^9, 
   3.7455222087865486`*^9}, {3.745522495593748*^9, 3.745522523138627*^9}, {
   3.745522706156953*^9, 3.7455227096945896`*^9}, {3.745530723369568*^9, 
   3.7455307399762*^9}, {3.745530780818081*^9, 3.74553079093705*^9}, {
   3.745530888394429*^9, 3.7455308957427645`*^9}, {3.745548653545377*^9, 
   3.745548704420512*^9}, {3.7455487810809593`*^9, 3.745548802832613*^9}, {
   3.74571155960535*^9, 3.7457117017081647`*^9}, {3.7457123613604646`*^9, 
   3.7457124069871902`*^9}, {3.745712452656483*^9, 3.7457124680777917`*^9}, {
   3.745720138383444*^9, 3.7457201506929674`*^9}, {3.74572051674215*^9, 
   3.7457205199445305`*^9}},ExpressionUUID->"f4fdeaf9-b151-45b7-a759-\
ba833f559761"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"atomDensity", " ", "=", " ", 
   RowBox[{"DensityPlot", "[", 
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"t", ",", "x"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"lowPosBdry", " ", "positionSpread"}], ",", " ", 
       RowBox[{"highPosBdry", " ", "positionSpread"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", 
       RowBox[{"lowTimeBdry", " ", "tau"}], ",", 
       RowBox[{"highTimeBdry", " ", "tau"}]}], "}"}], ",", 
     RowBox[{"ColorFunction", "\[Rule]", "\"\<CMYKColors\>\""}], ",", 
     RowBox[{"PlotPoints", "\[Rule]", "50"}], ",", " ", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
     RowBox[{"FrameLabel", "\[Rule]", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Time\>\"", ",", " ", "Large"}], "]"}], ",", " ", 
          "\"\<\>\""}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Position\>\"", ",", " ", "Large"}], "]"}], ",", " ", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<Wavefunction Amplitude\>\"", ",", " ", "Large"}], 
             "]"}], ",", " ", "Large"}], "]"}]}], "}"}]}], "}"}]}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", " ", 
     RowBox[{"Ticks", "\[Rule]", "None"}], ",", " ", 
     RowBox[{"Frame", "\[Rule]", "None"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.745711819469923*^9, 3.745711899032588*^9}, {
   3.7457119957816443`*^9, 3.7457119963596363`*^9}, {3.7457127725243406`*^9, 
   3.7457127866081505`*^9}, {3.745712823887315*^9, 3.7457128978545213`*^9}, {
   3.7457130120982056`*^9, 3.74571301615975*^9}, {3.7457130704922094`*^9, 
   3.7457130710545893`*^9}, {3.745713134225472*^9, 3.7457131369550037`*^9}, 
   3.7457131944664116`*^9, {3.7457132561531744`*^9, 3.7457132638965178`*^9}, {
   3.745713342617459*^9, 3.745713347828556*^9}, {3.74571353948907*^9, 
   3.745713547002943*^9}, {3.7457135905479355`*^9, 3.745713665261283*^9}, {
   3.745713825508127*^9, 3.745713977995733*^9}, {3.7457140146714954`*^9, 
   3.7457140351589594`*^9}, {3.7457142895875025`*^9, 
   3.7457142923995433`*^9}, {3.745716312665381*^9, 3.745716321596963*^9}, {
   3.745716443714304*^9, 3.7457164508970566`*^9}, {3.7457607340470543`*^9, 
   3.7457607347571564`*^9}, {3.7457608148728967`*^9, 3.745760815280806*^9}, {
   3.745808627471242*^9, 
   3.745808628180557*^9}},ExpressionUUID->"e922a2f7-fe5b-4332-9af2-\
0ec567b98082"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7457131411066475`*^9, 
  3.7457131426844077`*^9}},ExpressionUUID->"29e07501-0741-4b80-8264-\
f72edf867b43"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<braggInterferometerDensity.png\>\"", ",", "atomDensity"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.745713414051068*^9, 
  3.7457134705340834`*^9}},ExpressionUUID->"4a727c84-2b35-4672-93a7-\
91d09666ceb3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Next up: Bloch oscillations", "Section",
 CellChangeTimes->{{3.74551342607228*^9, 3.7455134271250052`*^9}, {
  3.7455356802084093`*^9, 
  3.7455356929653263`*^9}},ExpressionUUID->"39da70b5-7aa4-4cf3-9d1b-\
c64bcddc3d9e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"velocitySpread", " ", "=", " ", ".1"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Units", " ", "of", " ", 
     SubscriptBox["v", "r"]}], ",", " ", 
    RowBox[{
    "which", " ", "equals", " ", "one", " ", "in", " ", "these", " ", 
     "dimensionless", " ", 
     RowBox[{"units", "."}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"positionSpread", " ", "=", " ", 
    FractionBox["1", 
     RowBox[{"2", " ", "velocitySpread"}]]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "assuming", " ", "minimum", " ", "uncertainty", " ", "wavepacket"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NLatDep", " ", "=", " ", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TLoad", " ", "=", " ", "Pi"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NRamp", " ", "=", " ", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NBloch", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bdry", " ", "=", " ", "23"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"evaluate", " ", "over", " ", "range", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "bdry"}], "*", "positionSpread"}], ",", " ", 
      RowBox[{"bdry", "*", "positionSpread"}]}], "}"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]0", " ", "=", " ", 
    RowBox[{"0", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "4"}], " ", "NBloch"}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rampGrav", " ", "=", " ", "0.8576"}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"dimensionless", " ", "form", " ", "of", " ", "23", " ", 
    RowBox[{"kHz", "/", "ms"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rampRate", " ", "=", " ", 
   RowBox[{"NRamp", "*", "rampGrav"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BlochPeriod", " ", "=", " ", 
   FractionBox["8.", "rampRate"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TBloch", "=", " ", 
    RowBox[{"BlochPeriod", " ", "*", " ", "NBloch"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"TBBS", " ", "=", " ", 
     RowBox[{"BlochPeriod", " ", "*", " ", "NBloch"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TPropagate", " ", "=", " ", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InitPos", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NTLoad", " ", "=", " ", "7"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Exp", "[", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Omega]0", " ", "t"}], " ", "-", " ", 
       RowBox[{"2", " ", "x"}]}], ")"}]}], "]"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"x", " ", "+", " ", 
    RowBox[{
     FractionBox["bdry", "2"], "positionSpread"}]}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Psi]0", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox["Pi", "positionSpread"], "]"}], 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"x", " ", "-", " ", 
           RowBox[{"InitPos", " ", "positionSpread"}]}], "positionSpread"], 
         ")"}], "2"]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Hamiltonian", " ", "for", " ", "loading", " ", "atoms", " ", "into", " ", 
    "lattice"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"HamLoad", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], " ", "=", " ", 
     RowBox[{
      FractionBox["NLatDep", "2"], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"Exp", "[", 
         FractionBox[
          RowBox[{"-", "t"}], "TLoad"], "]"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"2", " ", "x"}], " ", "-", " ", 
         RowBox[{"\[Omega]0", " ", "t"}]}], " ", "]"}], ")"}]}]}], ";"}], " ",
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Hamiltonian", " ", "for", " ", "loading", " ", "and", " ", "unloading", 
    " ", "atoms", " ", "from", " ", "lattice"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"HamLoadUnload", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], " ", "=", " ", 
     RowBox[{
      FractionBox["NLatDep", "2"], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"Exp", "[", 
         FractionBox[
          RowBox[{"-", "t"}], "TLoad"], "]"}]}], ")"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"Exp", "[", 
         FractionBox[
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"NTLoad", " ", "TLoad"}], " ", "-", " ", "t"}], ")"}]}], 
          "TLoad"], "]"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"2", " ", "x"}], " ", "-", " ", 
         RowBox[{"\[Omega]0", " ", "t"}]}], " ", "]"}], ")"}]}]}], ";"}], " ",
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Hamiltonian", " ", "for", " ", "standard", " ", "Bloch", " ", 
    "oscillations", " ", 
    RowBox[{"(", 
     RowBox[{"single", " ", "frequency"}], ")"}]}], "  ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"HamTotal", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{
       FractionBox["NLatDep", "4"], 
       FractionBox["t", "TLoad"], " ", 
       RowBox[{"(", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"2", " ", "x"}], " ", "-", " ", 
          RowBox[{"\[Omega]0", " ", "t"}]}], "]"}], ")"}], 
       RowBox[{"UnitStep", "[", "t", "]"}], 
       RowBox[{"UnitStep", "[", 
        RowBox[{"TLoad", " ", "-", " ", "t"}], "]"}]}], " ", "+", " ", 
      RowBox[{
       FractionBox["NLatDep", "4"], 
       RowBox[{"(", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"2", " ", "x"}], " ", "-", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Omega]0", " ", "+", " ", 
             FractionBox[
              RowBox[{"rampRate", " ", 
               RowBox[{"(", 
                RowBox[{"t", "-", "TLoad"}], ")"}]}], "2"]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"t", "-", "TLoad"}], ")"}]}], " ", "-", " ", 
          RowBox[{"\[Omega]0", " ", "TLoad"}]}], "]"}], ")"}], 
       RowBox[{"UnitStep", "[", 
        RowBox[{"t", "-", "TLoad"}], "]"}], " ", 
       RowBox[{"UnitStep", "[", 
        RowBox[{"TLoad", " ", "+", " ", "TBloch", " ", "-", " ", "t"}], 
        "]"}]}], " ", "+", " ", 
      RowBox[{
       FractionBox["NLatDep", "4"], 
       RowBox[{"(", 
        FractionBox[
         RowBox[{"TLoad", " ", "-", " ", 
          RowBox[{"(", 
           RowBox[{"t", " ", "-", " ", 
            RowBox[{"(", 
             RowBox[{"TLoad", " ", "+", " ", "TBloch"}], ")"}]}], ")"}]}], 
         "TLoad"], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"2", " ", "x"}], "-", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Omega]0", " ", "+", " ", 
             RowBox[{"rampRate", " ", "TBloch"}]}], ")"}], "t"}], " ", "-", 
          " ", 
          RowBox[{"\[Omega]0", " ", "TLoad"}], " ", "-", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Omega]0", " ", "+", " ", 
             FractionBox[
              RowBox[{"rampRate", " ", "TBloch"}], "2"]}], ")"}], 
           "TBloch"}]}], "]"}], " ", ")"}], 
       RowBox[{"UnitStep", "[", 
        RowBox[{"t", " ", "-", " ", "TLoad", " ", "-", " ", "TBloch"}], "]"}], 
       RowBox[{"UnitStep", "[", 
        RowBox[{
         RowBox[{"2", " ", "TLoad"}], " ", "+", " ", "TBloch", " ", "-", " ", 
         "t"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Hamiltonian", " ", "for", " ", "a", " ", "Bloch", " ", "Beamsplitter"}], 
   " ", "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HamTotal", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{
      FractionBox["NLatDep", 
       RowBox[{"Sqrt", "[", "2", "]"}]], 
      FractionBox["t", "TLoad"], " ", 
      RowBox[{"(", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "x"}], "]"}], ")"}], 
      RowBox[{"UnitStep", "[", "t", "]"}], 
      RowBox[{"UnitStep", "[", 
       RowBox[{"TLoad", " ", "-", " ", "t"}], "]"}]}], " ", "+", " ", 
     RowBox[{
      FractionBox["NLatDep", 
       RowBox[{"Sqrt", "[", "2", "]"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "x"}], "]"}], 
        RowBox[{"Cos", "[", 
         FractionBox[
          RowBox[{"rampRate", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"t", "-", "TLoad"}], ")"}], "2"]}], "2"], "]"}]}], ")"}], 
      RowBox[{"UnitStep", "[", 
       RowBox[{"t", "-", "TLoad"}], "]"}], " ", 
      RowBox[{"UnitStep", "[", 
       RowBox[{"TLoad", " ", "+", " ", "TBloch", " ", "-", " ", "t"}], 
       "]"}]}], " ", "+", " ", 
     RowBox[{
      FractionBox["NLatDep", 
       RowBox[{"Sqrt", "[", "2", "]"}]], 
      RowBox[{"(", 
       FractionBox[
        RowBox[{"TLoad", " ", "-", " ", 
         RowBox[{"(", 
          RowBox[{"t", " ", "-", " ", 
           RowBox[{"(", 
            RowBox[{"TLoad", " ", "+", " ", "TBloch"}], ")"}]}], ")"}]}], 
        "TLoad"], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "x"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          FractionBox[
           RowBox[{"rampRate", " ", 
            SuperscriptBox["TBloch", "2"]}], "2"], "+", 
          RowBox[{"rampRate", " ", "TBloch", " ", 
           RowBox[{"(", 
            RowBox[{"t", "-", "TLoad", "-", "TBloch"}], ")"}]}]}], "]"}]}], 
       ")"}], 
      RowBox[{"UnitStep", "[", 
       RowBox[{"t", " ", "-", " ", "TLoad", " ", "-", " ", "TBloch"}], "]"}], 
      RowBox[{"UnitStep", "[", 
       RowBox[{
        RowBox[{"2", " ", "TLoad"}], " ", "+", " ", "TBloch", " ", "-", " ", 
        "t"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"HamLoad", "[", 
      RowBox[{"0", ",", "t"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"t", ",", " ", "0", ",", " ", 
       RowBox[{"NTLoad", " ", "TLoad"}]}], "}"}], ",", " ", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<MethodOfLines\>\"", ",", 
      RowBox[{"\"\<SpatialDiscretization\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<TensorProductGrid\>\"", ",", 
         RowBox[{
         "\"\<DifferenceOrder\>\"", "\[Rule]", "\"\<Pseudospectral\>\""}]}], 
        "}"}]}]}], "}"}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Psi]pi", "=", 
   RowBox[{"u", "/.", 
    RowBox[{"First", "@", 
     RowBox[{"NDSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"I", " ", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"u", "[", 
              RowBox[{"t", ",", "x"}], "]"}], ",", "t"}], "]"}]}], "\[Equal]", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"u", "[", 
               RowBox[{"t", ",", "x"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "2"}], "}"}]}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"HamTotal", "[", 
             RowBox[{"x", ",", "t"}], "]"}], " ", 
            RowBox[{"u", "[", 
             RowBox[{"t", ",", "x"}], "]"}]}]}]}], ",", 
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{"0.", ",", "x"}], "]"}], "\[Equal]", 
          RowBox[{"\[Psi]0", "[", 
           RowBox[{"x", ",", "0"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{"t", ",", 
            RowBox[{
             RowBox[{"-", "bdry"}], " ", "positionSpread"}]}], "]"}], 
          "\[Equal]", 
          RowBox[{"u", "[", 
           RowBox[{"t", ",", 
            RowBox[{"bdry", " ", "positionSpread"}]}], "]"}]}]}], "}"}], ",", 
       "u", ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0.", ",", " ", 
         RowBox[{
          RowBox[{"2.", " ", "TLoad"}], " ", "+", " ", "TBloch", " ", "+", 
          " ", "TPropagate"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{
          RowBox[{"-", "bdry"}], " ", "positionSpread"}], ",", 
         RowBox[{"bdry", " ", "positionSpread"}]}], "}"}], ",", " ", 
       RowBox[{"MaxStepFraction", "\[Rule]", 
        FractionBox["1", "16000"]}], ",", " ", 
       RowBox[{"MaxSteps", "\[Rule]", "100000"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Psi]pi", "=", 
     RowBox[{"u", "/.", 
      RowBox[{"First", "@", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"I", " ", 
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"u", "[", 
                RowBox[{"t", ",", "x"}], "]"}], ",", "t"}], "]"}]}], 
            "\[Equal]", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"u", "[", 
                 RowBox[{"t", ",", "x"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "2"}], "}"}]}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"HamLoadUnload", "[", 
               RowBox[{"x", ",", "t"}], "]"}], " ", 
              RowBox[{"u", "[", 
               RowBox[{"t", ",", "x"}], "]"}]}]}]}], ",", 
           RowBox[{
            RowBox[{"u", "[", 
             RowBox[{"0.", ",", "x"}], "]"}], "\[Equal]", 
            RowBox[{"\[Psi]0", "[", 
             RowBox[{"x", ",", "0"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"u", "[", 
             RowBox[{"t", ",", 
              RowBox[{
               RowBox[{"-", "bdry"}], " ", "positionSpread"}]}], "]"}], 
            "\[Equal]", 
            RowBox[{"u", "[", 
             RowBox[{"t", ",", 
              RowBox[{"bdry", " ", "positionSpread"}]}], "]"}]}]}], "}"}], 
         ",", "u", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0.", ",", " ", 
           RowBox[{"NTLoad", " ", "TLoad"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{
            RowBox[{"-", "bdry"}], " ", "positionSpread"}], ",", 
           RowBox[{"bdry", " ", "positionSpread"}]}], "}"}], ",", " ", 
         RowBox[{"MaxStepFraction", "\[Rule]", 
          FractionBox["1", "14000"]}], ",", " ", 
         RowBox[{"MaxSteps", "\[Rule]", "100000"}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "*)"}]}]}], "Input", "Input",
 CellChangeTimes->{{3.745530992253188*^9, 3.7455309922571783`*^9}, {
   3.745535702057037*^9, 3.745535820771864*^9}, {3.7455358616047707`*^9, 
   3.745535880493306*^9}, {3.745535921133726*^9, 3.7455360030787916`*^9}, {
   3.745536277066886*^9, 3.745536368868618*^9}, {3.7455364017497687`*^9, 
   3.7455364076001387`*^9}, {3.7455364529200563`*^9, 
   3.7455364532701235`*^9}, {3.745536569484933*^9, 3.745536572065039*^9}, {
   3.745536645255495*^9, 3.7455367104882126`*^9}, {3.745536800102788*^9, 
   3.7455368023507805`*^9}, {3.745536890571947*^9, 3.745536917148941*^9}, {
   3.7455369716829233`*^9, 3.745536972221485*^9}, {3.745537187479253*^9, 
   3.7455371968571973`*^9}, {3.7455372512073956`*^9, 3.745537251844691*^9}, {
   3.74553831419735*^9, 3.7455383326141453`*^9}, {3.7455383650674396`*^9, 
   3.745538380676736*^9}, {3.7455391268173556`*^9, 3.745539140313302*^9}, {
   3.745539198668402*^9, 3.745539198985593*^9}, {3.7455392890040407`*^9, 
   3.745539292480756*^9}, {3.7455396810186033`*^9, 3.7455397228239174`*^9}, {
   3.745539781675908*^9, 3.745539836072103*^9}, {3.7455398675769367`*^9, 
   3.7455398961017237`*^9}, 3.7455399478656974`*^9, {3.7455402431397*^9, 
   3.7455402808868446`*^9}, {3.745540324083918*^9, 3.745540393689953*^9}, 
   3.7455407632781715`*^9, {3.745541223197715*^9, 3.7455412245161905`*^9}, {
   3.7455427493685646`*^9, 3.745542754453978*^9}, {3.745549130617174*^9, 
   3.7455491737759647`*^9}, {3.745714165922657*^9, 3.7457141664225683`*^9}, {
   3.745714492602194*^9, 3.7457145071803904`*^9}, {3.746025144559661*^9, 
   3.7460251668498745`*^9}, {3.7460252005209646`*^9, 3.746025220672014*^9}, {
   3.746025253380021*^9, 3.746025275710361*^9}, {3.746025436589611*^9, 
   3.746025440388255*^9}, {3.7460257449696455`*^9, 3.746025753871971*^9}, {
   3.746025821428976*^9, 3.746025842567014*^9}, {3.7460260338510485`*^9, 
   3.746026039448209*^9}, {3.746026346654716*^9, 3.7460263701489954`*^9}, {
   3.7460267084038224`*^9, 3.74602680468812*^9}, {3.746026876223027*^9, 
   3.746026894228443*^9}, {3.746026939648452*^9, 3.7460269569272575`*^9}, {
   3.746028443676387*^9, 3.7460284448472567`*^9}, {3.7460296000843177`*^9, 
   3.7460296022016554`*^9}, {3.7460302971707983`*^9, 
   3.7460303082287693`*^9}, {3.746033850059106*^9, 3.746033903700498*^9}, {
   3.7460339579147615`*^9, 3.746034059258525*^9}, {3.7460340934338417`*^9, 
   3.7460342876532784`*^9}, {3.746034321163578*^9, 3.746034325022669*^9}, {
   3.7460343780100603`*^9, 3.7460344295663867`*^9}, {3.7460344775180387`*^9, 
   3.7460344958163533`*^9}, {3.7460352724440775`*^9, 
   3.7460353507039585`*^9}, {3.7460361352585936`*^9, 3.746036205249961*^9}, {
   3.74603649979828*^9, 3.7460365021310396`*^9}, {3.7460365521521454`*^9, 
   3.746036553984254*^9}, {3.746040622189706*^9, 3.746040671855174*^9}, {
   3.746040732054144*^9, 3.7460407440891075`*^9}, {3.7460408656787987`*^9, 
   3.746040906828904*^9}, {3.7460409379760327`*^9, 3.746041098625236*^9}, {
   3.746113719469031*^9, 3.7461137265406804`*^9}, {3.7461138299247975`*^9, 
   3.7461138722279315`*^9}, 3.7461139514352236`*^9, {3.7464587910740185`*^9, 
   3.7464587913742247`*^9}, {3.746458875651985*^9, 3.746458984149322*^9}, {
   3.7464591754746437`*^9, 3.746459233413924*^9}, {3.7464592855724306`*^9, 
   3.746459333352648*^9}, {3.746459477193959*^9, 3.746459522054982*^9}, {
   3.746459559196653*^9, 3.746459676984165*^9}, {3.7464713494422293`*^9, 
   3.7464714474761105`*^9}, {3.746471515987919*^9, 3.7464715160787015`*^9}, {
   3.746471553328376*^9, 3.7464715534699984`*^9}, {3.746480303941782*^9, 
   3.746480383282648*^9}, {3.746480794322363*^9, 3.746480834134886*^9}, {
   3.7464810495750046`*^9, 3.7464810558262806`*^9}, {3.7464810975090632`*^9, 
   3.746481115647551*^9}, {3.7464816089521236`*^9, 3.7464816100781136`*^9}, {
   3.746489813143015*^9, 3.746489935972272*^9}, {3.7464900819132338`*^9, 
   3.746490082095725*^9}, {3.746501345589351*^9, 3.7465013786629066`*^9}, {
   3.746552838726643*^9, 3.7465528484765916`*^9}, {3.7465704417326803`*^9, 
   3.746570442214423*^9}, {3.7513998848023157`*^9, 3.7514000107119007`*^9}, {
   3.7514000423688765`*^9, 3.751400135665444*^9}, {3.7514002772796073`*^9, 
   3.7514003720476604`*^9}, {3.7514004665721893`*^9, 
   3.7514004691178885`*^9}, {3.751400617066818*^9, 3.7514006175555058`*^9}, {
   3.751400664772935*^9, 3.7514006650731373`*^9}, {3.7525106124477572`*^9, 
   3.7525106297794313`*^9}, {3.752510670580309*^9, 3.7525106797926793`*^9}, {
   3.7525112809484234`*^9, 3.752511319494228*^9}, {3.7525113573958745`*^9, 
   3.752511437644286*^9}, {3.7525119188990517`*^9, 3.7525119342310524`*^9}, {
   3.7528094926580315`*^9, 3.752809500256344*^9}, {3.756494382346257*^9, 
   3.7564944277906885`*^9}, 3.756494536775119*^9, {3.7564946897084565`*^9, 
   3.7564946905691137`*^9}, {3.756514708668289*^9, 3.7565147088348417`*^9}, {
   3.7565742725169163`*^9, 3.7565742747240157`*^9}, {3.7565883902215476`*^9, 
   3.756588391818269*^9}, {3.7566566910890293`*^9, 3.75665669563589*^9}, {
   3.756828118107346*^9, 3.7568281203343606`*^9}, {3.7568282630325966`*^9, 
   3.7568282667765384`*^9}, {3.7568507989326615`*^9, 3.756850808778335*^9}, 
   3.7568508444109893`*^9, {3.7568508877326345`*^9, 3.7568508921607842`*^9}, {
   3.7571939004021626`*^9, 3.7571939017495537`*^9}, {3.7571984610938215`*^9, 
   3.757198461500748*^9}, {3.7571988863353977`*^9, 3.757198909007724*^9}, 
   3.7572719917800026`*^9, {3.757695226897024*^9, 
   3.7576952275373325`*^9}},ExpressionUUID->"2a184f61-3966-475d-a52c-\
b756c8c792a6"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.756494687647962*^9, 
  3.756494687658939*^9}},ExpressionUUID->"9812e969-3037-4f68-ade5-\
07991a53d2c3"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.746040957197544*^9, 
  3.7460409590436926`*^9}},ExpressionUUID->"9e3f5203-2de7-4dd8-97dd-\
17401bce3acf"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"Plot3D", "[", 
   RowBox[{
    RowBox[{"Abs", "[", 
     RowBox[{"HamTotal", "[", 
      RowBox[{"x", ",", "t"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", 
      RowBox[{
       RowBox[{"2.", " ", "TLoad"}], " ", "+", " ", "TBloch", " ", "+", " ", 
       "TPropagate"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{
       RowBox[{"-", "bdry"}], " ", "positionSpread"}], ",", 
      RowBox[{"bdry", " ", "positionSpread"}]}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
    RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}], ",", " ", 
    RowBox[{"PlotPoints", "\[Rule]", "150"}], ",", " ", 
    RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7464808910177593`*^9, 3.746480927605915*^9}, {
  3.7464899653379374`*^9, 
  3.746489999518959*^9}},ExpressionUUID->"b821f14b-9103-42bf-9c7f-\
e351f3dd20fe"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7455369899291773`*^9, 3.7455369917602825`*^9}, {
  3.7455372588040977`*^9, 
  3.7455372600138655`*^9}},ExpressionUUID->"812272f8-bfc5-43df-bf08-\
6b8fdd6cfc18"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"atomDensity", " ", "=", " ", 
    RowBox[{"DensityPlot", "[", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"\[Psi]", "[", 
        RowBox[{"t", ",", "x"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{
         RowBox[{"-", "bdry"}], " ", "positionSpread"}], ",", " ", 
        RowBox[{"bdry", " ", "positionSpread"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "TLoad"}], "}"}], ",", 
      RowBox[{"ColorFunction", "\[Rule]", "\"\<CMYKColors\>\""}], ",", 
      RowBox[{"PlotPoints", "\[Rule]", "50"}], ",", " ", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
      RowBox[{"FrameLabel", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Time\>\"", ",", " ", "Large"}], "]"}], ",", " ", 
           "\"\<\>\""}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Position\>\"", ",", " ", "Large"}], "]"}], ",", " ", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<Wavefunction Amplitude\>\"", ",", " ", "Large"}], 
              "]"}], ",", " ", "Large"}], "]"}]}], "}"}]}], "}"}]}], ",", " ", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", " ", 
      RowBox[{"Ticks", "\[Rule]", "None"}], ",", " ", 
      RowBox[{"Frame", "\[Rule]", "None"}]}], "]"}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"atomDensity", " ", "=", " ", 
   RowBox[{"DensityPlot", "[", 
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{"\[Psi]pi", "[", 
       RowBox[{"t", ",", "x"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{
        RowBox[{"-", "bdry"}], " ", "positionSpread"}], ",", " ", 
       RowBox[{"bdry", " ", "positionSpread"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", 
       RowBox[{"NTLoad", " ", "TLoad"}]}], "}"}], ",", 
     RowBox[{"ColorFunction", "\[Rule]", "\"\<CMYKColors\>\""}], ",", 
     RowBox[{"PlotPoints", "\[Rule]", "200"}], ",", " ", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
     RowBox[{"FrameLabel", "\[Rule]", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Time\>\"", ",", " ", "Large"}], "]"}], ",", " ", 
          "\"\<\>\""}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Position\>\"", ",", " ", "Large"}], "]"}], ",", " ", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<Wavefunction Amplitude\>\"", ",", " ", "Large"}], 
             "]"}], ",", " ", "Large"}], "]"}]}], "}"}]}], "}"}]}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", " ", 
     RowBox[{"Ticks", "\[Rule]", "None"}], ",", " ", 
     RowBox[{"Frame", "\[Rule]", "None"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.746025347468893*^9, 3.746025403274706*^9}, {
   3.746025447043627*^9, 3.746025451236021*^9}, {3.7460261598053083`*^9, 
   3.7460261760431848`*^9}, {3.7460263886981773`*^9, 
   3.7460263892993765`*^9}, {3.7460344399867*^9, 3.7460344492824135`*^9}, {
   3.746035216860729*^9, 3.7460352289098597`*^9}, {3.7460352926337986`*^9, 
   3.7460352930477457`*^9}, {3.7460404414877996`*^9, 3.746040445891136*^9}, {
   3.746040633977333*^9, 3.7460406367674627`*^9}, {3.7460573352972865`*^9, 
   3.7460573356947126`*^9}, {3.7464597180104446`*^9, 3.7464597368410864`*^9}, 
   3.7464797120929346`*^9, {3.746480029351883*^9, 3.7464800306772842`*^9}, {
   3.746480111952638*^9, 3.7464801152548*^9}, {3.746489513691298*^9, 
   3.746489517108185*^9}, {3.7464995569879465`*^9, 3.746499558347316*^9}, {
   3.746500227971372*^9, 3.7465002286076765`*^9}, {3.746536170195589*^9, 
   3.7465361887599406`*^9}, {3.746538080662321*^9, 3.746538085788578*^9}, {
   3.7465383571568375`*^9, 3.746538362427741*^9}, 3.7514936785805044`*^9, {
   3.751493795215991*^9, 3.751493809812488*^9}, {3.7565741482294517`*^9, 
   3.7565741522526937`*^9}, {3.7565883402572117`*^9, 
   3.7565883425381365`*^9}, {3.75665656702944*^9, 3.7566565674293385`*^9}, {
   3.756828073832814*^9, 3.756828077331424*^9}, {3.756828129974568*^9, 
   3.756828130347596*^9}, {3.756850232746838*^9, 3.756850256077387*^9}, 
   3.757112168170018*^9},ExpressionUUID->"c1a063e6-8d6d-4be3-b215-\
7b936e93a69a"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
    "\"\<blochBSampSquared_N1_LatDep8_Ramp035_bdry26_tloadpi_propagate8_\
MaxFrac18000_posSpread5.png\>\"", ",", "atomDensity"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"pl", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Plot", "[", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{"\[Psi]pi", "[", 
             RowBox[{"t", ",", "x"}], "]"}], "]"}], "2"], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{
             RowBox[{"-", "bdry"}], " ", "positionSpread"}], ",", 
            RowBox[{"bdry", " ", "positionSpread"}]}], "}"}], ",", 
          RowBox[{"Ticks", "\[Rule]", "None"}], ",", " ", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "1"}], "}"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", 
          RowBox[{
           RowBox[{"2", " ", "TLoad"}], "+", "TBloch", "+", "TPropagate"}], 
          ",", ".1"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Export", "[", 
       RowBox[{"\"\<blochBS_N1.gif\>\"", ",", "pl", ",", 
        RowBox[{"AnimationRepetitions", "\[Rule]", "Infinity"}], ",", 
        RowBox[{"\"\<DisplayDurations\>\"", "\[Rule]", ".05"}]}], "]"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"pl", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Re", "[", 
              RowBox[{"\[Psi]pi", "[", 
               RowBox[{"t", ",", "x"}], "]"}], "]"}], ",", " ", 
             RowBox[{"Im", "[", 
              RowBox[{"\[Psi]pi", "[", 
               RowBox[{"t", ",", "x"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{
              RowBox[{"-", "bdry"}], " ", "positionSpread"}], ",", 
             RowBox[{"bdry", " ", "positionSpread"}]}], "}"}], ",", 
           RowBox[{"Ticks", "\[Rule]", "None"}], ",", " ", 
           RowBox[{"PlotStyle", " ", "\[Rule]", " ", 
            RowBox[{"{", 
             RowBox[{"Orange", ",", " ", "Blue"}], "}"}]}], ",", " ", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", " ", "1"}], "}"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", 
           RowBox[{
            RowBox[{"2", " ", "TLoad"}], "+", "TBloch", "+", "TPropagate"}], 
           ",", ".1"}], "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"\"\<blochBS_ReIm_N1.gif\>\"", ",", "pl", ",", 
       RowBox[{"AnimationRepetitions", "\[Rule]", "Infinity"}], ",", 
       RowBox[{"\"\<DisplayDurations\>\"", "\[Rule]", ".05"}]}], "]"}]}], 
    "*)"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.74602620811751*^9, 3.7460263107558556`*^9}, {
   3.7460264824042187`*^9, 3.7460264837938185`*^9}, {3.7460284203716955`*^9, 
   3.746028421579466*^9}, {3.7460294692484107`*^9, 3.7460294703235364`*^9}, {
   3.7460336766348405`*^9, 3.746033678171282*^9}, {3.746479786041168*^9, 
   3.7464798359845996`*^9}, {3.7464799004392214`*^9, 3.746479946723439*^9}, 
   3.746480287479814*^9, {3.7464895646739798`*^9, 3.746489582238973*^9}, {
   3.746537878892889*^9, 3.746537889756835*^9}, {3.746538069396739*^9, 
   3.74653806958127*^9}, {3.7465381887482495`*^9, 3.7465381902352467`*^9}, 
   3.746538387217436*^9, {3.7465384176600213`*^9, 3.74653842541129*^9}, {
   3.7465384687391157`*^9, 3.7465385504954405`*^9}, {3.7465385881656976`*^9, 
   3.7465385924731984`*^9}, {3.7465386298452597`*^9, 
   3.7465386658330107`*^9}, {3.7465388087180557`*^9, 3.746538850852172*^9}, {
   3.7465389225349007`*^9, 3.7465389628815804`*^9}, {3.746539171193687*^9, 
   3.7465391717022924`*^9}, {3.746570339579543*^9, 3.746570365854247*^9}, {
   3.7564945237509995`*^9, 3.756494524533872*^9}, {3.756574208867227*^9, 
   3.756574227398636*^9}, {3.7565883814490323`*^9, 3.7565883820424366`*^9}, {
   3.7566565422606907`*^9, 3.756656542996739*^9}, {3.7568282316535406`*^9, 
   3.756828248507453*^9}, {3.7568509043880653`*^9, 
   3.7568509148580914`*^9}},ExpressionUUID->"04786fef-bab8-40b2-a7d1-\
24767394b3f0"],

Cell[BoxData["\"\<latticeLoadAndHold_veloSpread0-8_NLatDep8_tLoad6_phi0.png\>\
\""], "Input",
 CellChangeTimes->{{3.7460293672451277`*^9, 
  3.7460293676739817`*^9}},ExpressionUUID->"22f499df-6dd7-4ad4-814a-\
c3bbc576afca"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7455369899291773`*^9, 
  3.7455369917602825`*^9}},ExpressionUUID->"67ce1729-2d92-4b46-8051-\
8535d20fdc85"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]1", "[", "x_", "]"}], " ", "=", " ", 
   RowBox[{"\[Psi]", "[", 
    RowBox[{"TLoad", ",", "x"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HamBloch", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], " ", "=", " ", 
    RowBox[{
     FractionBox["NLatDep", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"2", " ", "x"}], " ", "-", " ", 
        RowBox[{"t", " ", 
         RowBox[{"(", 
          RowBox[{"\[Omega]0", "+", 
           FractionBox[
            RowBox[{"rampRate", " ", "t"}], "2"]}], ")"}]}], " ", "-", " ", 
        RowBox[{"\[Omega]0", " ", "TLoad"}]}], "]"}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    FractionBox[
     RowBox[{"3", "+", 
      RowBox[{"2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"rampRate", " ", "t"}], "]"}]}]}], "4"], " ", "+"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Psi]Bloch", "=", " ", 
   RowBox[{"v", "/.", 
    RowBox[{"First", "@", 
     RowBox[{"NDSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"I", " ", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"v", "[", 
              RowBox[{"t", ",", "x"}], "]"}], ",", "t"}], "]"}]}], "\[Equal]", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"v", "[", 
               RowBox[{"t", ",", "x"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "2"}], "}"}]}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"HamBloch", "[", 
             RowBox[{"x", ",", "t"}], "]"}], " ", 
            RowBox[{"v", "[", 
             RowBox[{"t", ",", "x"}], "]"}]}]}]}], ",", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"0.", ",", "x"}], "]"}], "\[Equal]", 
          RowBox[{"\[Psi]1", "[", "x", "]"}]}], ",", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"t", ",", 
            RowBox[{
             RowBox[{"-", "bdry"}], " ", "positionSpread"}]}], "]"}], 
          "\[Equal]", 
          RowBox[{"v", "[", 
           RowBox[{"t", ",", 
            RowBox[{"bdry", " ", "positionSpread"}]}], "]"}]}]}], "}"}], ",", 
       "v", ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0.", ",", " ", "TBloch"}], " ", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{
          RowBox[{"-", "bdry"}], " ", "positionSpread"}], ",", 
         RowBox[{"bdry", " ", "positionSpread"}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<MethodOfLines\>\"", ",", 
          RowBox[{"\"\<SpatialDiscretization\>\"", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<TensorProductGrid\>\"", ",", 
             RowBox[{
             "\"\<DifferenceOrder\>\"", "\[Rule]", 
              "\"\<Pseudospectral\>\""}]}], "}"}]}]}], "}"}]}], ",", " ", 
       RowBox[{"MaxStepFraction", "\[Rule]", 
        FractionBox["1", "800"]}]}], "]"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.745536736287285*^9, 3.7455367394478436`*^9}, 
   3.7455368966377416`*^9, 3.7455370199340105`*^9, {3.7455371642792377`*^9, 
   3.7455371690066075`*^9}, {3.745537267904782*^9, 3.745537269654109*^9}, {
   3.745537300566519*^9, 3.74553740140012*^9}, {3.745549303720622*^9, 
   3.745549304312726*^9}},ExpressionUUID->"a40528e2-8e3c-47d3-8f29-\
993c71e890c6"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"Abs", "[", 
     RowBox[{"\[Psi]Bloch", "[", 
      RowBox[{"t", ",", "x"}], "]"}], "]"}], "2"], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "TBloch"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{
      RowBox[{"-", " ", "bdry"}], " ", "positionSpread"}], ",", 
     RowBox[{"bdry", " ", "positionSpread"}]}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
   RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}], ",", " ", 
   RowBox[{"PlotPoints", "\[Rule]", "50"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.745536736287285*^9, 3.745536768559064*^9}, {
  3.7455378216471853`*^9, 3.74553782923691*^9}, {3.745539232006321*^9, 
  3.745539241093045*^9}, {3.7455492642307415`*^9, 
  3.745549280401862*^9}},ExpressionUUID->"4968bbf6-aa74-4954-aa06-\
1e9dea20942e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"velocitySpread", " ", "=", " ", ".1"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Units", " ", "of", " ", 
     SubscriptBox["v", "r"]}], ",", " ", 
    RowBox[{
    "which", " ", "equals", " ", "one", " ", "in", " ", "these", " ", 
     "dimensionless", " ", 
     RowBox[{"units", "."}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"positionSpread", " ", "=", " ", 
    FractionBox["1", 
     RowBox[{"2", " ", "velocitySpread"}]]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "assuming", " ", "minimum", " ", "uncertainty", " ", "wavepacket"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NLatDep", " ", "=", " ", "8."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TLoad", " ", "=", " ", "10."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NRamp", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NBloch", " ", "=", " ", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bdry", " ", "=", " ", "6"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"evaluate", " ", "over", " ", "range", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "bdry"}], "*", "positionSpread"}], ",", " ", 
      RowBox[{"bdry", "*", "positionSpread"}]}], "}"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rampGrav", " ", "=", " ", "0.8576"}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"dimensionless", " ", "form", " ", "of", " ", "23", " ", 
    RowBox[{"kHz", "/", "ms"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rampRate", " ", "=", " ", 
   RowBox[{"NRamp", "*", "rampGrav"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BlochPeriod", " ", "=", " ", 
   FractionBox["8", "rampRate"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TBBS", " ", "=", " ", 
    RowBox[{"BlochPeriod", " ", "*", " ", "NBloch"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Psi]0", "[", "x", "]"}], " ", "=", " ", 
  RowBox[{
   RowBox[{"Sqrt", "[", 
    FractionBox["Pi", "positionSpread"], "]"}], 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["x", "positionSpread"], ")"}], "2"]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Ham", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], " ", "=", " ", 
    RowBox[{
     FractionBox["NLatDep", "2"], 
     FractionBox["t", "TLoad"], " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["5", "4"], "+", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "x"}], "]"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Piecewise", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox["NLatDep", "2"], 
         FractionBox["t", "TLoad"], " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox["5", "4"], "+", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "x"}], "]"}]}], ")"}]}], ",", " ", 
        RowBox[{"t", "<", "TLoad"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox["NLatDep", "2"], 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"3", "+", 
             RowBox[{"2", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"rampRate", " ", 
                RowBox[{"(", 
                 RowBox[{"t", "-", "TLoad"}], ")"}]}], "]"}]}]}], "4"], " ", 
           "+", " ", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "x"}], "]"}], 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"rampRate", " ", 
               RowBox[{"(", 
                RowBox[{"t", "-", "TLoad"}], ")"}]}], "2"], "]"}]}]}], 
          ")"}]}], ",", " ", 
        RowBox[{"TLoad", "\[LessEqual]", " ", "t", " ", "<", " ", 
         RowBox[{"TLoad", "+", "TBBS"}]}]}], " ", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox["NLatDep", "2"], 
         FractionBox[
          RowBox[{"TLoad", " ", "-", " ", 
           RowBox[{"(", 
            RowBox[{"t", " ", "-", " ", 
             RowBox[{"(", 
              RowBox[{"TLoad", " ", "+", " ", "TBBS"}], ")"}]}], ")"}]}], 
          "TLoad"], " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"3", "+", 
             RowBox[{"2", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"rampRate", " ", "TBBS"}], "]"}]}]}], "4"], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "x"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"rampRate", " ", "TBBS"}], "2"], "]"}]}]}], ")"}]}], 
        ",", " ", 
        RowBox[{"t", "\[GreaterEqual]", " ", 
         RowBox[{"TLoad", " ", "+", " ", "TBBS"}]}]}], "}"}]}], "}"}], "]"}], 
   "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"Ham", "[", 
     RowBox[{"0", ",", "t"}], "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"t", ",", " ", "0", ",", " ", 
      RowBox[{
       RowBox[{"2", " ", "TLoad"}], " ", "+", " ", "TBBS"}]}], "}"}], ",", 
    " ", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Psi]", "=", 
   RowBox[{"u", "/.", 
    RowBox[{"First", "@", 
     RowBox[{"NDSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"I", " ", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"u", "[", 
              RowBox[{"t", ",", "x"}], "]"}], ",", "t"}], "]"}]}], "\[Equal]", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"u", "[", 
               RowBox[{"t", ",", "x"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "2"}], "}"}]}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"Ham", "[", 
             RowBox[{"x", ",", "t"}], "]"}], " ", 
            RowBox[{"u", "[", 
             RowBox[{"t", ",", "x"}], "]"}]}]}]}], ",", 
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{"0.", ",", "x"}], "]"}], "\[Equal]", 
          RowBox[{"\[Psi]0", "[", "x", "]"}]}], ",", 
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{"t", ",", 
            RowBox[{
             RowBox[{"-", "bdry"}], " ", "positionSpread"}]}], "]"}], 
          "\[Equal]", 
          RowBox[{"u", "[", 
           RowBox[{"t", ",", 
            RowBox[{"bdry", " ", "positionSpread"}]}], "]"}]}]}], "}"}], ",", 
       "u", ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0.", ",", " ", "TLoad"}], " ", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{
          RowBox[{"-", "bdry"}], " ", "positionSpread"}], ",", 
         RowBox[{"bdry", " ", "positionSpread"}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<MethodOfLines\>\"", ",", 
          RowBox[{"\"\<SpatialDiscretization\>\"", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<TensorProductGrid\>\"", ",", 
             RowBox[{
             "\"\<DifferenceOrder\>\"", "\[Rule]", 
              "\"\<Pseudospectral\>\""}]}], "}"}]}]}], "}"}]}], ",", " ", 
       RowBox[{"MaxStepFraction", "\[Rule]", 
        FractionBox["1", "500"]}]}], "]"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.745503657202985*^9, 3.7455036713391476`*^9}, {
   3.745503734974684*^9, 3.745503788407276*^9}, {3.7455038388834424`*^9, 
   3.7455039849603915`*^9}, {3.745504244434579*^9, 3.7455042827049394`*^9}, {
   3.745504344205162*^9, 3.745504355705547*^9}, {3.7455044164623833`*^9, 
   3.745504539075261*^9}, {3.74550459058949*^9, 3.745504629172309*^9}, {
   3.7455046610055056`*^9, 3.7455046683668833`*^9}, {3.7455047177777185`*^9, 
   3.7455047430578156`*^9}, {3.745504790704603*^9, 3.7455047920070705`*^9}, {
   3.745504828452306*^9, 3.745504964590331*^9}, {3.7455051217257767`*^9, 
   3.745505128436738*^9}, {3.7455053054532347`*^9, 3.7455054124494877`*^9}, {
   3.7455055320889964`*^9, 3.7455055826800394`*^9}, {3.745505631899927*^9, 
   3.7455057391730547`*^9}, {3.745505810459181*^9, 3.74550583481907*^9}, {
   3.745506018920811*^9, 3.745506075434641*^9}, {3.7455061418971725`*^9, 
   3.7455061640978055`*^9}, {3.7455064984325542`*^9, 3.745506526763862*^9}, {
   3.745506565215152*^9, 3.7455065724870095`*^9}, 3.745506612701668*^9, {
   3.7455067474760237`*^9, 3.745506749690864*^9}, {3.7455070547726946`*^9, 
   3.7455070586827154`*^9}, {3.7455076283145866`*^9, 3.745507644531578*^9}, {
   3.745507754361323*^9, 3.745507787300411*^9}, {3.7455078281812425`*^9, 
   3.7455078284091682`*^9}, {3.7455078790653877`*^9, 
   3.7455078900663424`*^9}, {3.74550792606151*^9, 3.745507960759823*^9}, {
   3.7455080458127675`*^9, 3.745508098033742*^9}, {3.745508162269261*^9, 
   3.7455081627112484`*^9}, {3.7455082363297544`*^9, 
   3.7455082418207054`*^9}, {3.7455083246789465`*^9, 3.745508360769211*^9}, {
   3.745508888269575*^9, 3.745509083224592*^9}, {3.7455091676128354`*^9, 
   3.745509262411154*^9}, {3.745509349885604*^9, 3.745509426822401*^9}, {
   3.745509523847493*^9, 3.745509864891259*^9}, {3.7455098997241135`*^9, 
   3.7455100374836164`*^9}, {3.7455100889297085`*^9, 3.745510130668782*^9}, {
   3.74551028182728*^9, 3.745510310582469*^9}, {3.745510392459525*^9, 
   3.7455104267394333`*^9}, {3.7455105054525127`*^9, 
   3.7455105883807974`*^9}, {3.7455107500110617`*^9, 
   3.7455107518089542`*^9}, {3.7455120219380655`*^9, 
   3.7455120237873774`*^9}, {3.745512846546953*^9, 3.745512847830757*^9}, {
   3.7455310349501143`*^9, 3.745531057648472*^9}, {3.7455310894694557`*^9, 
   3.7455310939973583`*^9}, {3.7455311478099346`*^9, 
   3.7455311481071367`*^9}, {3.7455312739001136`*^9, 3.745531302314848*^9}, {
   3.7455319519716864`*^9, 3.7455319553765883`*^9}, {3.745532343231595*^9, 
   3.7455323506368093`*^9}, {3.745532459710397*^9, 3.745532461228341*^9}, 
   3.7455325255006247`*^9, {3.745532577065856*^9, 3.7455325775246315`*^9}, {
   3.745532696549629*^9, 3.7455326987776766`*^9}, {3.7455327514599233`*^9, 
   3.745532752727537*^9}, {3.745533777358856*^9, 3.745533778585578*^9}, {
   3.745535414680143*^9, 
   3.7455354147888527`*^9}},ExpressionUUID->"8569faef-3df9-44d3-8c10-\
753c938446e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Plot3D", "[", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"Abs", "[", 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"t", ",", "x"}], "]"}], "]"}], "2"], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", "TLoad"}], " ", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{
       RowBox[{"-", "bdry"}], " ", "positionSpread"}], ",", 
      RowBox[{"bdry", " ", "positionSpread"}]}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
    RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}], ",", " ", 
    RowBox[{"PlotPoints", "\[Rule]", "50"}]}], "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.745503657202985*^9, 3.7455036713391476`*^9}, {
   3.745503734974684*^9, 3.745503788407276*^9}, {3.7455038388834424`*^9, 
   3.7455039849603915`*^9}, {3.745504244434579*^9, 3.7455042827049394`*^9}, {
   3.745504344205162*^9, 3.745504355705547*^9}, {3.7455044164623833`*^9, 
   3.745504539075261*^9}, {3.74550459058949*^9, 3.745504629172309*^9}, {
   3.7455046610055056`*^9, 3.7455046683668833`*^9}, {3.7455047177777185`*^9, 
   3.7455047430578156`*^9}, {3.745504790704603*^9, 3.7455047920070705`*^9}, {
   3.745504828452306*^9, 3.745504964590331*^9}, {3.7455051217257767`*^9, 
   3.745505128436738*^9}, {3.7455053054532347`*^9, 3.7455054124494877`*^9}, {
   3.7455055320889964`*^9, 3.7455055826800394`*^9}, {3.745505631899927*^9, 
   3.7455057391730547`*^9}, {3.745505810459181*^9, 3.74550583481907*^9}, {
   3.745506018920811*^9, 3.745506075434641*^9}, {3.7455061418971725`*^9, 
   3.7455061640978055`*^9}, {3.7455064984325542`*^9, 3.745506526763862*^9}, {
   3.745506565215152*^9, 3.7455065724870095`*^9}, 3.745506612701668*^9, {
   3.7455067474760237`*^9, 3.745506749690864*^9}, {3.7455070547726946`*^9, 
   3.7455070586827154`*^9}, {3.7455076283145866`*^9, 3.745507644531578*^9}, {
   3.745507754361323*^9, 3.745507787300411*^9}, {3.7455078281812425`*^9, 
   3.7455078284091682`*^9}, {3.7455078790653877`*^9, 
   3.7455078900663424`*^9}, {3.74550792606151*^9, 3.745507960759823*^9}, {
   3.7455080458127675`*^9, 3.745508098033742*^9}, {3.745508162269261*^9, 
   3.7455081627112484`*^9}, {3.7455082363297544`*^9, 
   3.7455082418207054`*^9}, {3.7455083246789465`*^9, 3.745508360769211*^9}, {
   3.745508888269575*^9, 3.745509083224592*^9}, {3.7455091676128354`*^9, 
   3.745509262411154*^9}, {3.745509349885604*^9, 3.745509426822401*^9}, {
   3.745509523847493*^9, 3.745509864891259*^9}, {3.7455098997241135`*^9, 
   3.7455099101834183`*^9}, {3.745510601730651*^9, 3.745510634562832*^9}, {
   3.745531820390236*^9, 3.7455318456108513`*^9}, {3.7455326650547757`*^9, 
   3.7455326697343035`*^9}, {3.745532730954708*^9, 3.7455327358256965`*^9}, {
   3.745532891949576*^9, 3.7455330926184464`*^9}, {3.745533127775517*^9, 
   3.7455331520366993`*^9}},ExpressionUUID->"105f666a-bf6b-498b-accd-\
d8f0fb16206f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]1", "[", "x_", "]"}], " ", "=", " ", 
   RowBox[{"\[Psi]", "[", 
    RowBox[{"TLoad", ",", "x"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HamBBS", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], " ", "=", " ", 
    RowBox[{
     FractionBox["NLatDep", "2"], 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "x"}], "]"}], 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"rampRate", " ", "t"}], "2"], "]"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    FractionBox[
     RowBox[{"3", "+", 
      RowBox[{"2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"rampRate", " ", "t"}], "]"}]}]}], "4"], " ", "+"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bdry", " ", "=", " ", "20"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Psi]BBS", " ", "=", " ", 
   RowBox[{"v", "/.", 
    RowBox[{"First", "@", 
     RowBox[{"NDSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"I", " ", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"v", "[", 
              RowBox[{"t", ",", "x"}], "]"}], ",", "t"}], "]"}]}], "\[Equal]", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"v", "[", 
               RowBox[{"t", ",", "x"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "2"}], "}"}]}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"HamBBS", "[", 
             RowBox[{"x", ",", "t"}], "]"}], " ", 
            RowBox[{"v", "[", 
             RowBox[{"t", ",", "x"}], "]"}]}]}]}], ",", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"0.", ",", "x"}], "]"}], "\[Equal]", 
          RowBox[{"\[Psi]1", "[", "x", "]"}]}], ",", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"t", ",", 
            RowBox[{
             RowBox[{"-", "bdry"}], " ", "positionSpread"}]}], "]"}], 
          "\[Equal]", 
          RowBox[{"v", "[", 
           RowBox[{"t", ",", 
            RowBox[{"bdry", " ", "positionSpread"}]}], "]"}]}]}], "}"}], ",", 
       "v", ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0.", ",", " ", "TBBS"}], " ", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{
          RowBox[{"-", "bdry"}], " ", "positionSpread"}], ",", 
         RowBox[{"bdry", " ", "positionSpread"}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<MethodOfLines\>\"", ",", 
          RowBox[{"\"\<SpatialDiscretization\>\"", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<TensorProductGrid\>\"", ",", 
             RowBox[{
             "\"\<DifferenceOrder\>\"", "\[Rule]", 
              "\"\<Pseudospectral\>\""}]}], "}"}]}]}], "}"}]}], ",", " ", 
       RowBox[{"MaxStepFraction", "\[Rule]", 
        FractionBox["1", "400"]}]}], "]"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.745503657202985*^9, 3.7455036713391476`*^9}, {
   3.745503734974684*^9, 3.745503788407276*^9}, {3.7455038388834424`*^9, 
   3.7455039849603915`*^9}, {3.745504244434579*^9, 3.7455042827049394`*^9}, {
   3.745504344205162*^9, 3.745504355705547*^9}, {3.7455044164623833`*^9, 
   3.745504539075261*^9}, {3.74550459058949*^9, 3.745504629172309*^9}, {
   3.7455046610055056`*^9, 3.7455046683668833`*^9}, {3.7455047177777185`*^9, 
   3.7455047430578156`*^9}, {3.745504790704603*^9, 3.7455047920070705`*^9}, {
   3.745504828452306*^9, 3.745504964590331*^9}, {3.7455051217257767`*^9, 
   3.745505128436738*^9}, {3.7455053054532347`*^9, 3.7455054124494877`*^9}, {
   3.7455055320889964`*^9, 3.7455055826800394`*^9}, {3.745505631899927*^9, 
   3.7455057391730547`*^9}, {3.745505810459181*^9, 3.74550583481907*^9}, {
   3.745506018920811*^9, 3.745506075434641*^9}, {3.7455061418971725`*^9, 
   3.7455061640978055`*^9}, {3.7455064984325542`*^9, 3.745506526763862*^9}, {
   3.745506565215152*^9, 3.7455065724870095`*^9}, 3.745506612701668*^9, {
   3.7455067474760237`*^9, 3.745506749690864*^9}, {3.7455070547726946`*^9, 
   3.7455070586827154`*^9}, {3.7455076283145866`*^9, 3.745507644531578*^9}, {
   3.745507754361323*^9, 3.745507787300411*^9}, {3.7455078281812425`*^9, 
   3.7455078284091682`*^9}, {3.7455078790653877`*^9, 
   3.7455078900663424`*^9}, {3.74550792606151*^9, 3.745507960759823*^9}, {
   3.7455080458127675`*^9, 3.745508098033742*^9}, {3.745508162269261*^9, 
   3.7455081627112484`*^9}, {3.7455082363297544`*^9, 
   3.7455082418207054`*^9}, {3.7455083246789465`*^9, 3.745508360769211*^9}, {
   3.745508888269575*^9, 3.745509083224592*^9}, {3.7455091676128354`*^9, 
   3.745509262411154*^9}, {3.745509349885604*^9, 3.745509426822401*^9}, {
   3.745509523847493*^9, 3.745509864891259*^9}, {3.7455098997241135`*^9, 
   3.7455099101834183`*^9}, {3.745510601730651*^9, 3.745510634562832*^9}, {
   3.745531820390236*^9, 3.7455318456108513`*^9}, {3.7455326650547757`*^9, 
   3.7455326697343035`*^9}, {3.745532730954708*^9, 3.7455327358256965`*^9}, {
   3.745532891949576*^9, 3.7455328943591385`*^9}, {3.745533144799035*^9, 
   3.745533156260414*^9}, {3.745533195027837*^9, 3.745533196597644*^9}, {
   3.745534217628649*^9, 3.745534218727714*^9}, {3.74553425120993*^9, 
   3.745534269170947*^9}, {3.7455343382922707`*^9, 3.7455343722848015`*^9}, {
   3.7455353024086466`*^9, 3.745535328195752*^9}, {3.745535454473025*^9, 
   3.745535462149515*^9}},ExpressionUUID->"0d8fb0ce-25dd-4de9-8d0b-\
6526dbff76c9"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"Abs", "[", 
     RowBox[{"\[Psi]BBS", "[", 
      RowBox[{"t", ",", "x"}], "]"}], "]"}], "2"], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "TBBS"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{
      RowBox[{"-", "bdry"}], " ", "positionSpread"}], ",", 
     RowBox[{"bdry", " ", "positionSpread"}]}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
   RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}], ",", " ", 
   RowBox[{"PlotPoints", "\[Rule]", "50"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.745503657202985*^9, 3.7455036713391476`*^9}, {
   3.745503734974684*^9, 3.745503788407276*^9}, {3.7455038388834424`*^9, 
   3.7455039849603915`*^9}, {3.745504244434579*^9, 3.7455042827049394`*^9}, {
   3.745504344205162*^9, 3.745504355705547*^9}, {3.7455044164623833`*^9, 
   3.745504539075261*^9}, {3.74550459058949*^9, 3.745504629172309*^9}, {
   3.7455046610055056`*^9, 3.7455046683668833`*^9}, {3.7455047177777185`*^9, 
   3.7455047430578156`*^9}, {3.745504790704603*^9, 3.7455047920070705`*^9}, {
   3.745504828452306*^9, 3.745504964590331*^9}, {3.7455051217257767`*^9, 
   3.745505128436738*^9}, {3.7455053054532347`*^9, 3.7455054124494877`*^9}, {
   3.7455055320889964`*^9, 3.7455055826800394`*^9}, {3.745505631899927*^9, 
   3.7455057391730547`*^9}, {3.745505810459181*^9, 3.74550583481907*^9}, {
   3.745506018920811*^9, 3.745506075434641*^9}, {3.7455061418971725`*^9, 
   3.7455061640978055`*^9}, {3.7455064984325542`*^9, 3.745506526763862*^9}, {
   3.745506565215152*^9, 3.7455065724870095`*^9}, 3.745506612701668*^9, {
   3.7455067474760237`*^9, 3.745506749690864*^9}, {3.7455070547726946`*^9, 
   3.7455070586827154`*^9}, {3.7455076283145866`*^9, 3.745507644531578*^9}, {
   3.745507754361323*^9, 3.745507787300411*^9}, {3.7455078281812425`*^9, 
   3.7455078284091682`*^9}, {3.7455078790653877`*^9, 
   3.7455078900663424`*^9}, {3.74550792606151*^9, 3.745507960759823*^9}, {
   3.7455080458127675`*^9, 3.745508098033742*^9}, {3.745508162269261*^9, 
   3.7455081627112484`*^9}, {3.7455082363297544`*^9, 
   3.7455082418207054`*^9}, {3.7455083246789465`*^9, 3.745508360769211*^9}, {
   3.745508888269575*^9, 3.745509083224592*^9}, {3.7455091676128354`*^9, 
   3.745509262411154*^9}, {3.745509349885604*^9, 3.745509426822401*^9}, {
   3.745509523847493*^9, 3.745509864891259*^9}, {3.7455098997241135`*^9, 
   3.7455099101834183`*^9}, {3.745510601730651*^9, 3.745510634562832*^9}, {
   3.745531820390236*^9, 3.7455318456108513`*^9}, {3.7455326650547757`*^9, 
   3.7455326697343035`*^9}, {3.745532730954708*^9, 3.7455327358256965`*^9}, {
   3.745532891949576*^9, 3.7455328943591385`*^9}, {3.745533144799035*^9, 
   3.745533156260414*^9}, {3.745533195027837*^9, 
   3.745533205769139*^9}},ExpressionUUID->"c2aaa8ee-b084-4e9b-9aa2-\
fe46db6d864c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pl", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Re", "[", 
          RowBox[{"\[Psi]", "[", 
           RowBox[{"t", ",", "x"}], "]"}], "]"}], ",", " ", 
         RowBox[{"Im", "[", 
          RowBox[{"\[Psi]", "[", 
           RowBox[{"t", ",", "x"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{
          RowBox[{"-", "bdry"}], " ", "positionSpread"}], ",", 
         RowBox[{"bdry", " ", "positionSpread"}]}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1.5"}], ",", " ", "1.5"}], "}"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", 
       RowBox[{
        RowBox[{"2", " ", "TLoad"}], " ", "+", " ", "TBBS"}], ",", ".4"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"\"\<revolve.gif\>\"", ",", "pl", ",", 
   RowBox[{"AnimationRepetitions", "\[Rule]", "Infinity"}], ",", 
   RowBox[{"\"\<DisplayDurations\>\"", "\[Rule]", ".1"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.745503657202985*^9, 3.7455036713391476`*^9}, {
   3.745503734974684*^9, 3.745503788407276*^9}, {3.7455038388834424`*^9, 
   3.7455039849603915`*^9}, {3.745504244434579*^9, 3.7455042827049394`*^9}, {
   3.745504344205162*^9, 3.745504355705547*^9}, {3.7455044164623833`*^9, 
   3.745504539075261*^9}, {3.74550459058949*^9, 3.745504629172309*^9}, {
   3.7455046610055056`*^9, 3.7455046683668833`*^9}, {3.7455047177777185`*^9, 
   3.7455047430578156`*^9}, {3.745504790704603*^9, 3.7455047920070705`*^9}, {
   3.745504828452306*^9, 3.745504964590331*^9}, {3.7455051217257767`*^9, 
   3.745505128436738*^9}, {3.7455053054532347`*^9, 3.7455054124494877`*^9}, {
   3.7455055320889964`*^9, 3.7455055826800394`*^9}, {3.745505631899927*^9, 
   3.7455057391730547`*^9}, {3.745505810459181*^9, 3.74550583481907*^9}, {
   3.745506018920811*^9, 3.745506075434641*^9}, {3.7455061418971725`*^9, 
   3.7455061640978055`*^9}, {3.7455064984325542`*^9, 3.745506526763862*^9}, {
   3.745506565215152*^9, 3.7455065724870095`*^9}, 3.745506612701668*^9, {
   3.7455067474760237`*^9, 3.745506749690864*^9}, {3.7455070547726946`*^9, 
   3.7455070586827154`*^9}, {3.7455076283145866`*^9, 3.745507644531578*^9}, {
   3.745507754361323*^9, 3.745507787300411*^9}, {3.7455078281812425`*^9, 
   3.7455078284091682`*^9}, {3.7455078790653877`*^9, 
   3.7455078900663424`*^9}, {3.74550792606151*^9, 3.745507960759823*^9}, {
   3.7455080458127675`*^9, 3.745508098033742*^9}, {3.745508162269261*^9, 
   3.7455081627112484`*^9}, {3.7455082363297544`*^9, 
   3.7455082418207054`*^9}, {3.7455083246789465`*^9, 3.745508360769211*^9}, {
   3.745508888269575*^9, 3.745509083224592*^9}, {3.7455091676128354`*^9, 
   3.745509262411154*^9}, {3.745509349885604*^9, 3.745509426822401*^9}, {
   3.745509523847493*^9, 3.745509864891259*^9}, {3.7455098997241135`*^9, 
   3.7455099101834183`*^9}, {3.745510601730651*^9, 3.745510634562832*^9}, {
   3.745531820390236*^9, 
   3.7455318456108513`*^9}},ExpressionUUID->"66b3f9de-53a5-4706-9406-\
121c4ba5fa33"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"a", "[", 
   RowBox[{"x_", ",", "t_"}], "]"}], " ", "=", " ", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["x", "2"]}], "-", " ", 
      SuperscriptBox["t", "2"]}], "]"}], ",", "t"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"a", "[", 
  RowBox[{"x", ",", "0"}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7455052431342583`*^9, 
  3.7455052933283978`*^9}},ExpressionUUID->"f0390c30-c5b7-4858-b841-\
a86cc5990410"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7455069533366747`*^9, 3.745507084191861*^9}, {
  3.745507146338813*^9, 3.745507226114447*^9}, {3.7455072664161153`*^9, 
  3.7455073312243285`*^9}, {3.745507566685683*^9, 
  3.7455076247037745`*^9}},ExpressionUUID->"460af746-4ce4-4cdb-a23b-\
b51fef84c439"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.7458554418686237`*^9, 3.745855548040671*^9}, 
   3.7458555820709515`*^9},ExpressionUUID->"434fb6d9-5849-4723-ab5b-\
73d6c6e0924d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rampRate", " ", "=", " ", "5"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HamBBS", "[", 
     RowBox[{"x", ",", "t"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "x"}], "]"}], 
     RowBox[{"Cos", "[", 
      FractionBox[
       RowBox[{"rampRate", " ", 
        SuperscriptBox["t", "2"]}], "2"], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"HamBBS", "[", 
    RowBox[{"x", ",", "t"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", " ", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
   RowBox[{"ColorFunction", "\[Rule]", "\"\<BlueGreenYellow\>\""}], ",", " ", 
   RowBox[{"PlotPoints", "\[Rule]", "100"}], ",", " ", 
   RowBox[{"AxesLabel", "\[Rule]", "Automatic"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7458555931334505`*^9, 3.7458556612215247`*^9}, {
  3.7458556993163486`*^9, 3.7458556998485794`*^9}, {3.7458557588902783`*^9, 
  3.7458557613843784`*^9}, {3.7458558031893516`*^9, 3.745855812779361*^9}, {
  3.74585585768967*^9, 
  3.7458559118604593`*^9}},ExpressionUUID->"50455e4c-70aa-417b-bea8-\
4305e223282c"]
}, Open  ]]
},
WindowSize->{896, 816},
WindowMargins->{{92, Automatic}, {52, Automatic}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 199, 3, 67, "Section",ExpressionUUID->"66701289-77cc-4b93-9b7d-5f01bf8e8c07"],
Cell[782, 27, 4210, 61, 56, "Text",ExpressionUUID->"28f44461-6f3c-4da7-8303-101559b45e7e"],
Cell[4995, 90, 16316, 373, 1223, "Input",ExpressionUUID->"2cb89133-37e0-4820-bfaa-bb83990bee4b"],
Cell[21314, 465, 7826, 166, 466, "Input",ExpressionUUID->"1ba31ce5-6638-4346-9a68-6e10f336784e"],
Cell[29143, 633, 6047, 125, 304, "Input",ExpressionUUID->"c4b57cfe-78de-4cfa-9af6-f88ea5bf4f3e"],
Cell[35193, 760, 2868, 54, 181, "Input",ExpressionUUID->"f4fdeaf9-b151-45b7-a759-ba833f559761"],
Cell[38064, 816, 2670, 54, 124, "Input",ExpressionUUID->"e922a2f7-fe5b-4332-9af2-0ec567b98082"],
Cell[40737, 872, 156, 3, 28, "Input",ExpressionUUID->"29e07501-0741-4b80-8264-f72edf867b43"],
Cell[40896, 877, 260, 6, 28, "Input",ExpressionUUID->"4a727c84-2b35-4672-93a7-91d09666ceb3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41193, 888, 226, 4, 67, "Section",ExpressionUUID->"39da70b5-7aa4-4cf3-9d1b-c64bcddc3d9e"],
Cell[41422, 894, 21542, 523, 1718, "Input",ExpressionUUID->"2a184f61-3966-475d-a52c-b756c8c792a6"],
Cell[62967, 1419, 152, 3, 28, "Input",ExpressionUUID->"9812e969-3037-4f68-ade5-07991a53d2c3"],
Cell[63122, 1424, 154, 3, 28, "Input",ExpressionUUID->"9e3f5203-2de7-4dd8-97dd-17401bce3acf"],
Cell[63279, 1429, 986, 24, 86, "Input",ExpressionUUID->"b821f14b-9103-42bf-9c7f-e351f3dd20fe"],
Cell[64268, 1455, 209, 4, 28, "Input",ExpressionUUID->"812272f8-bfc5-43df-bf08-6b8fdd6cfc18"],
Cell[64480, 1461, 4622, 97, 238, "Input",ExpressionUUID->"c1a063e6-8d6d-4be3-b215-7b936e93a69a"],
Cell[69105, 1560, 4460, 94, 219, "Input",ExpressionUUID->"04786fef-bab8-40b2-a7d1-24767394b3f0"],
Cell[73568, 1656, 223, 4, 28, "Input",ExpressionUUID->"22f499df-6dd7-4ad4-814a-c3bbc576afca"],
Cell[73794, 1662, 156, 3, 28, "Input",ExpressionUUID->"67ce1729-2d92-4b46-8051-8535d20fdc85"],
Cell[73953, 1667, 3556, 96, 292, "Input",ExpressionUUID->"a40528e2-8e3c-47d3-8f29-993c71e890c6"],
Cell[77512, 1765, 900, 21, 55, "Input",ExpressionUUID->"4968bbf6-aa74-4954-aa06-1e9dea20942e"],
Cell[78415, 1788, 10824, 268, 807, "Input",ExpressionUUID->"8569faef-3df9-44d3-8c10-753c938446e2"],
Cell[89242, 2058, 2903, 49, 75, "Input",ExpressionUUID->"105f666a-bf6b-498b-accd-d8f0fb16206f"],
Cell[92148, 2109, 5655, 126, 311, "Input",ExpressionUUID->"0d8fb0ce-25dd-4de9-8d0b-6526dbff76c9"],
Cell[97806, 2237, 2894, 48, 55, "Input",ExpressionUUID->"c2aaa8ee-b084-4e9b-9aa2-fe46db6d864c"],
Cell[100703, 2287, 3213, 61, 67, "Input",ExpressionUUID->"66b3f9de-53a5-4706-9406-121c4ba5fa33"],
Cell[103919, 2350, 544, 16, 71, "Input",ExpressionUUID->"f0390c30-c5b7-4858-b841-a86cc5990410"],
Cell[104466, 2368, 304, 5, 28, "Input",ExpressionUUID->"460af746-4ce4-4cdb-a23b-b51fef84c439"],
Cell[104773, 2375, 198, 3, 48, "Input",ExpressionUUID->"434fb6d9-5849-4723-ab5b-73d6c6e0924d"],
Cell[104974, 2380, 1386, 36, 154, "Input",ExpressionUUID->"50455e4c-70aa-417b-bea8-4305e223282c"]
}, Open  ]]
}
]
*)

